<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Mini-Project #02 – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-91c80d9448edf1303d093bd44d5bbc76.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-mini-projects" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Mini Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-mini-projects">    
        <li>
    <a class="dropdown-item" href="./mp01.html">
 <span class="dropdown-text">MP01 — Data Wrangling</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./mp02.html">
 <span class="dropdown-text">MP02 — YIMBY (Backyards)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://michael-weylandt.com/STA9750/" target="_blank"> 
<span class="menu-text">Course Page</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/abbaswaseer/STA9750-2025-FALL"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#making-backyards-affordable-for-all-a-yimby-data-analysis" id="toc-making-backyards-affordable-for-all-a-yimby-data-analysis" class="nav-link active" data-scroll-target="#making-backyards-affordable-for-all-a-yimby-data-analysis">Making Backyards Affordable for All: A YIMBY Data Analysis</a>
  <ul class="collapse">
  <li><a href="#introduction-and-research-questions" id="toc-introduction-and-research-questions" class="nav-link" data-scroll-target="#introduction-and-research-questions">Introduction and Research Questions</a>
  <ul class="collapse">
  <li><a href="#task-1-data-import" id="toc-task-1-data-import" class="nav-link" data-scroll-target="#task-1-data-import">Task 1: Data Import</a></li>
  </ul></li>
  <li><a href="#data-integration-and-initial-exploration" id="toc-data-integration-and-initial-exploration" class="nav-link" data-scroll-target="#data-integration-and-initial-exploration">Data Integration and Initial Exploration</a>
  <ul class="collapse">
  <li><a href="#task-2-multi-table-questions" id="toc-task-2-multi-table-questions" class="nav-link" data-scroll-target="#task-2-multi-table-questions">Task 2: Multi-Table Questions</a></li>
  <li><a href="#task-3initial-visualizations" id="toc-task-3initial-visualizations" class="nav-link" data-scroll-target="#task-3initial-visualizations">Task 3:Initial Visualizations</a></li>
  <li><a href="#task-4-building-indices-of-housing-affordability-and-housing-stock-growth" id="toc-task-4-building-indices-of-housing-affordability-and-housing-stock-growth" class="nav-link" data-scroll-target="#task-4-building-indices-of-housing-affordability-and-housing-stock-growth">Task 4: Building Indices of Housing Affordability and Housing Stock Growth</a></li>
  <li><a href="#task-5-housing-growth" id="toc-task-5-housing-growth" class="nav-link" data-scroll-target="#task-5-housing-growth">Task 5: Housing Growth</a></li>
  <li><a href="#construct-your-metric-in-two-parts" id="toc-construct-your-metric-in-two-parts" class="nav-link" data-scroll-target="#construct-your-metric-in-two-parts">Construct your metric in two parts:</a></li>
  <li><a href="#task-6-visualization" id="toc-task-6-visualization" class="nav-link" data-scroll-target="#task-6-visualization">Task 6: Visualization</a></li>
  <li><a href="#visualization-1" id="toc-visualization-1" class="nav-link" data-scroll-target="#visualization-1">Visualization 1</a></li>
  <li><a href="#visualization-2" id="toc-visualization-2" class="nav-link" data-scroll-target="#visualization-2">Visualization 2</a></li>
  <li><a href="#findings" id="toc-findings" class="nav-link" data-scroll-target="#findings">Findings</a></li>
  <li><a href="#task-7-policy-brief" id="toc-task-7-policy-brief" class="nav-link" data-scroll-target="#task-7-policy-brief">Task 7 — Policy Brief</a></li>
  <li><a href="#extra-credit-opportunities" id="toc-extra-credit-opportunities" class="nav-link" data-scroll-target="#extra-credit-opportunities">Extra Credit Opportunities</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Mini-Project #02</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="making-backyards-affordable-for-all-a-yimby-data-analysis" class="level1">
<h1>Making Backyards Affordable for All: A YIMBY Data Analysis</h1>
<section id="introduction-and-research-questions" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-research-questions">Introduction and Research Questions</h2>
<p>This mini-project identifies the most “YIMBY” CBSAs by building two evidence-based metrics from ACS and BLS data: - <em>Rent Burden Index (RBI):</em> how much income a typical resident spends on rent (with intuitive re-scaling). - <em>Housing Growth Index (HGI):</em> permitting performance relative to both population size (instantaneous) and 5-year population growth (rate-based), then combined.</p>
<p>I will:</p>
<ol type="1">
<li>Ingest instructor-provided ACS &amp; BLS/QCEW data (Task 1);<br>
</li>
<li>Perform multi-table analysis (Task 2) and basic visualizations (Task 3);<br>
</li>
<li>Build and present RBI (Task 4) and HGI (Task 5);<br>
</li>
<li>Relate RBI and HGI to flag “YIMBY success” (Task 6);<br>
</li>
<li>Write a concise policy brief (Task 7).</li>
<li>Extra Credit Opportunities</li>
</ol>
<section id="task-1-data-import" class="level3">
<h3 class="anchored" data-anchor-id="task-1-data-import">Task 1: Data Import</h3>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>get_building_permits <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start_year =</span> <span class="dv">2009</span>, <span class="at">end_year =</span> <span class="dv">2023</span>){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"housing_units_{start_year}_{end_year}.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        HISTORICAL_YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, <span class="dv">2018</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        HISTORICAL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(HISTORICAL_YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            historical_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"https://www.census.gov/construction/bps/txt/tb3u{yy}.txt"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            LINES <span class="ot">&lt;-</span> <span class="fu">readLines</span>(historical_url)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>)]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            CBSA_LINES <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(LINES, <span class="st">"^[[:digit:]]"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>            CBSA <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">str_sub</span>(LINES[CBSA_LINES], <span class="dv">5</span>, <span class="dv">10</span>))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            PERMIT_LINES <span class="ot">&lt;-</span> <span class="fu">str_detect</span>(<span class="fu">str_sub</span>(LINES, <span class="dv">48</span>, <span class="dv">53</span>), <span class="st">"[[:digit:]]"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            PERMITS <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">str_sub</span>(LINES[PERMIT_LINES], <span class="dv">48</span>, <span class="dv">53</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data_frame</span>(<span class="at">CBSA =</span> CBSA,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">new_housing_units_permitted =</span> PERMITS, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">year =</span> yy)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        CURRENT_YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2019</span>, end_year)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        CURRENT_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(CURRENT_YEARS, <span class="cf">function</span>(yy){</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        current_url <span class="ot">&lt;-</span>        <span class="fu">glue</span>(<span class="st">"https://www.census.gov/construction/bps/xls/msaannual_{yy}99.xls"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>            temp <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">download.file</span>(current_url, <span class="at">destfile =</span> temp, <span class="at">mode=</span><span class="st">"wb"</span>)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>            fallback <span class="ot">&lt;-</span> <span class="cf">function</span>(.f1, .f2){</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                <span class="cf">function</span>(...){</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">tryCatch</span>(<span class="fu">.f1</span>(...), </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                             <span class="at">error=</span><span class="cf">function</span>(e) <span class="fu">.f2</span>(...))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>            reader <span class="ot">&lt;-</span> <span class="fu">fallback</span>(read_xlsx, read_xls)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            <span class="fu">reader</span>(temp, <span class="at">skip=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>                <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(CBSA, Total) <span class="sc">|&gt;</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">year =</span> yy) <span class="sc">|&gt;</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>                <span class="fu">rename</span>(<span class="at">new_housing_units_permitted =</span> Total)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        }) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">rbind</span>(HISTORICAL_DATA, CURRENT_DATA)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>PERMITS <span class="ot">&lt;-</span> <span class="fu">get_building_permits</span>()</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PERMITS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,658 × 3
    CBSA new_housing_units_permitted  year
   &lt;dbl&gt;                       &lt;dbl&gt; &lt;dbl&gt;
 1 10180                         214  2009
 2 10420                         741  2009
 3 10500                         213  2009
 4 10580                        1380  2009
 5 10740                        1692  2009
 6 10780                         396  2009
 7 10900                        1648  2009
 8 11020                         125  2009
 9 11100                         642  2009
10 11180                         122  2009
# ℹ 5,648 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>get_bls_industry_codes <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, <span class="st">"bls_industry_codes.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(dplyr)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(tidyr)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(readr)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        resp <span class="ot">&lt;-</span> <span class="fu">request</span>(<span class="st">"https://www.bls.gov"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_url_path</span>(<span class="st">"cew"</span>, <span class="st">"classifications"</span>, <span class="st">"industry"</span>, <span class="st">"industry-titles.htm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_error</span>(<span class="at">is_error =</span> \(resp) <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">req_perform</span>()</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">resp_check_status</span>(resp)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> <span class="fu">resp_body_html</span>(resp) <span class="sc">|&gt;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">html_element</span>(<span class="st">"#naics_titles"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">html_table</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">title =</span> <span class="fu">str_trim</span>(<span class="fu">str_remove</span>(<span class="fu">str_remove</span>(<span class="st">`</span><span class="at">Industry Title</span><span class="st">`</span>, Code), <span class="st">"NAICS"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">Industry Title</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">depth =</span> <span class="fu">if_else</span>(<span class="fu">nchar</span>(Code) <span class="sc">&lt;=</span> <span class="dv">5</span>, <span class="fu">nchar</span>(Code) <span class="sc">-</span> <span class="dv">1</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(depth))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># These were looked up manually on bls.gov after finding </span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># they were presented as ranges. Since there are only three</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># it was easier to manually handle than to special-case everything else</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>        naics_missing <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>            <span class="sc">~</span>Code, <span class="sc">~</span>title, <span class="sc">~</span>depth, </span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">"31"</span>, <span class="st">"Manufacturing"</span>, <span class="dv">1</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">"32"</span>, <span class="st">"Manufacturing"</span>, <span class="dv">1</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">"33"</span>, <span class="st">"Manufacturing"</span>, <span class="dv">1</span>,</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"44"</span>, <span class="st">"Retail"</span>, <span class="dv">1</span>, </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"45"</span>, <span class="st">"Retail"</span>, <span class="dv">1</span>,</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"48"</span>, <span class="st">"Transportation and Warehousing"</span>, <span class="dv">1</span>, </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"49"</span>, <span class="st">"Transportation and Warehousing"</span>, <span class="dv">1</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(naics_table, naics_missing)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        naics_table <span class="ot">&lt;-</span> naics_table <span class="sc">|&gt;</span> </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(depth <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level4_title=</span>title) <span class="sc">|&gt;</span> </span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">level1_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">2</span>), </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level2_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">3</span>), </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>                   <span class="at">level3_code =</span> <span class="fu">str_sub</span>(Code, <span class="at">end=</span><span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level1_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level1_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level2_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level2_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>            <span class="fu">left_join</span>(naics_table, <span class="fu">join_by</span>(level3_code <span class="sc">==</span> Code)) <span class="sc">|&gt;</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level3_title=</span>title) <span class="sc">|&gt;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(<span class="sc">-</span><span class="fu">starts_with</span>(<span class="st">"depth"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rename</span>(<span class="at">level4_code =</span> Code) <span class="sc">|&gt;</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>            <span class="fu">select</span>(level1_title, level2_title, level3_title, level4_title, </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>                   level1_code,  level2_code,  level3_code,  level4_code) <span class="sc">|&gt;</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>            <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="st">"code"</span>), as.integer))</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(naics_table, fname)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>INDUSTRY_CODES <span class="ot">&lt;-</span> <span class="fu">get_bls_industry_codes</span>()</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(INDUSTRY_CODES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 798 × 8
   level1_title   level2_title level3_title level4_title level1_code level2_code
   &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;
 1 Agriculture, … Crop produc… Oilseed and… Soybean far…          11         111
 2 Agriculture, … Crop produc… Oilseed and… Oilseed (ex…          11         111
 3 Agriculture, … Crop produc… Oilseed and… Dry pea and…          11         111
 4 Agriculture, … Crop produc… Oilseed and… Wheat farmi…          11         111
 5 Agriculture, … Crop produc… Oilseed and… Corn farming          11         111
 6 Agriculture, … Crop produc… Oilseed and… Rice farming          11         111
 7 Agriculture, … Crop produc… Oilseed and… Other grain…          11         111
 8 Agriculture, … Crop produc… Vegetable a… Vegetable a…          11         111
 9 Agriculture, … Crop produc… Fruit and t… Orange grov…          11         111
10 Agriculture, … Crop produc… Fruit and t… Citrus (exc…          11         111
# ℹ 788 more rows
# ℹ 2 more variables: level3_code &lt;dbl&gt;, level4_code &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>get_bls_qcew_annual_averages <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">start_year=</span><span class="dv">2009</span>, <span class="at">end_year=</span><span class="dv">2023</span>){</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"bls_qcew_{start_year}_{end_year}.csv.gz"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, fname)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    YEARS <span class="ot">&lt;-</span> <span class="fu">seq</span>(start_year, end_year)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    YEARS <span class="ot">&lt;-</span> YEARS[YEARS <span class="sc">!=</span> <span class="dv">2020</span>] <span class="co"># Drop Covid year to match ACS</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname)){</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        ALL_DATA <span class="ot">&lt;-</span> <span class="fu">map</span>(YEARS, <span class="at">.progress=</span><span class="cn">TRUE</span>, <span class="fu">possibly</span>(<span class="cf">function</span>(yy){</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>            fname_inner <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">"data"</span>, <span class="st">"mp02"</span>, <span class="fu">glue</span>(<span class="st">"{yy}_qcew_annual_singlefile.zip"</span>))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fname_inner)){</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">request</span>(<span class="st">"https://www.bls.gov"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_url_path</span>(<span class="st">"cew"</span>, <span class="st">"data"</span>, <span class="st">"files"</span>, yy, <span class="st">"csv"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">glue</span>(<span class="st">"{yy}_annual_singlefile.zip"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_headers</span>(<span class="st">`</span><span class="at">User-Agent</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:143.0) Gecko/20100101 Firefox/143.0"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_retry</span>(<span class="at">max_tries=</span><span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">req_perform</span>(fname_inner)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span>(<span class="fu">file.info</span>(fname_inner)<span class="sc">$</span>size <span class="sc">&lt;</span> <span class="fl">755e5</span>){</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>                <span class="fu">warning</span>(<span class="fu">sQuote</span>(fname_inner), <span class="st">"appears corrupted. Please delete and retry this step."</span>)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">read_csv</span>(fname_inner, </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show_col_types=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">YEAR =</span> yy) <span class="sc">|&gt;</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(area_fips, </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>                       industry_code, </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>                       annual_avg_emplvl, </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>                       total_annual_wages, </span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>                       YEAR) <span class="sc">|&gt;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">nchar</span>(industry_code) <span class="sc">&lt;=</span> <span class="dv">5</span>, </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">str_starts</span>(area_fips, <span class="st">"C"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(<span class="fu">str_detect</span>(industry_code, <span class="st">"-"</span>, <span class="at">negate=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">FIPS =</span> area_fips, </span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">INDUSTRY =</span> <span class="fu">as.integer</span>(industry_code), </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">EMPLOYMENT =</span> <span class="fu">as.integer</span>(annual_avg_emplvl), </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>                       <span class="at">TOTAL_WAGES =</span> total_annual_wages) <span class="sc">|&gt;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(<span class="sc">-</span>area_fips, </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>industry_code, </span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>annual_avg_emplvl, </span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">-</span>total_annual_wages) <span class="sc">|&gt;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 10 is a special value: "all industries" , so omit</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(INDUSTRY <span class="sc">!=</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">AVG_WAGE =</span> TOTAL_WAGES <span class="sc">/</span> EMPLOYMENT)</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>        })) <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>()</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>        <span class="fu">write_csv</span>(ALL_DATA, fname)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    ALL_DATA <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(fname, <span class="at">show_col_types=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    ALL_DATA_YEARS <span class="ot">&lt;-</span> <span class="fu">unique</span>(ALL_DATA<span class="sc">$</span>YEAR)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    YEARS_DIFF <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(YEARS, ALL_DATA_YEARS)</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(YEARS_DIFF) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">"Download failed for the following years: "</span>, YEARS_DIFF, </span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>             <span class="st">". Please delete intermediate files and try again."</span>)</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    ALL_DATA</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>WAGES <span class="ot">&lt;-</span> <span class="fu">get_bls_qcew_annual_averages</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="data-integration-and-initial-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-integration-and-initial-exploration">Data Integration and Initial Exploration</h2>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reusable helpers — unique naming</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>as_std_cbsa <span class="ot">&lt;-</span> <span class="cf">function</span>(geoid_chr) <span class="fu">paste0</span>(<span class="st">"C"</span>, geoid_chr)     <span class="co"># ACS style "C" prefix</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>as_std_cbsa_bls <span class="ot">&lt;-</span> <span class="cf">function</span>(fips_chr) <span class="fu">paste0</span>(fips_chr, <span class="st">"0"</span>)   <span class="co"># BLS style trailing "0"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Catalog of CBSAs (names + std keys)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>cbsa_catalog <span class="ot">&lt;-</span> INCOME <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(GEOID, NAME) <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">std_cbsa =</span> <span class="fu">as_std_cbsa</span>(GEOID))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Small formatter helpers</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>comma <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>pc    <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">d =</span> <span class="dv">2</span>) <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>x, d), <span class="st">"%"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>usd   <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">d =</span> <span class="dv">0</span>) <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">format</span>(<span class="fu">round</span>(x, d), <span class="at">big.mark=</span><span class="st">","</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Soft assert for required columns</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>require_cols <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cols){</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">all</span>(cols <span class="sc">%in%</span> <span class="fu">names</span>(df)))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">invisible</span>(<span class="cn">TRUE</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">require_cols</span>(PERMITS,    <span class="fu">c</span>(<span class="st">"CBSA"</span>,<span class="st">"year"</span>,<span class="st">"new_housing_units_permitted"</span>))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">require_cols</span>(INCOME,     <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"NAME"</span>,<span class="st">"year"</span>,<span class="st">"household_income"</span>))</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="fu">require_cols</span>(HOUSEHOLDS, <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>,<span class="st">"households"</span>))</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="fu">require_cols</span>(POPULATION, <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>,<span class="st">"population"</span>))</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">require_cols</span>(WAGES,      <span class="fu">c</span>(<span class="st">"FIPS"</span>,<span class="st">"INDUSTRY"</span>,<span class="st">"EMPLOYMENT"</span>,<span class="st">"TOTAL_WAGES"</span>,<span class="st">"YEAR"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="task-2-multi-table-questions" class="level3">
<h3 class="anchored" data-anchor-id="task-2-multi-table-questions">Task 2: Multi-Table Questions</h3>
<section id="which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive" class="level4">
<h4 class="anchored" data-anchor-id="which-cbsa-by-name-permitted-the-largest-number-of-new-housing-units-in-the-decade-from-2010-to-2019-inclusive">1- Which CBSA (by name) permitted the largest number of new housing units in the decade from 2010 to 2019 (inclusive)?</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>permits_decade <span class="ot">&lt;-</span> PERMITS <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2010</span>, year <span class="sc">&lt;=</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(CBSA) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">permits_10s =</span> <span class="fu">sum</span>(new_housing_units_permitted, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(permits_10s <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(cbsa_catalog, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"CBSA"</span> <span class="ot">=</span> <span class="st">"GEOID"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(permits_10s))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>permits_decade <span class="sc">|&gt;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="st">`</span><span class="at">CBSA Name</span><span class="st">`</span> <span class="ot">=</span> NAME, <span class="st">`</span><span class="at">Permits (2010–2019)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">comma</span>(permits_10s)) <span class="sc">|&gt;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"*Top 15 CBSAs by Permits (2010–2019)*"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="st">"right"</span>, <span class="at">columns =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="wxrzmirzpi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wxrzmirzpi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wxrzmirzpi thead, #wxrzmirzpi tbody, #wxrzmirzpi tfoot, #wxrzmirzpi tr, #wxrzmirzpi td, #wxrzmirzpi th {
  border-style: none;
}

#wxrzmirzpi p {
  margin: 0;
  padding: 0;
}

#wxrzmirzpi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wxrzmirzpi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wxrzmirzpi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wxrzmirzpi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wxrzmirzpi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wxrzmirzpi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wxrzmirzpi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wxrzmirzpi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wxrzmirzpi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wxrzmirzpi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wxrzmirzpi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wxrzmirzpi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wxrzmirzpi .gt_spanner_row {
  border-bottom-style: hidden;
}

#wxrzmirzpi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wxrzmirzpi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wxrzmirzpi .gt_from_md > :first-child {
  margin-top: 0;
}

#wxrzmirzpi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wxrzmirzpi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wxrzmirzpi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wxrzmirzpi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wxrzmirzpi .gt_row_group_first td {
  border-top-width: 2px;
}

#wxrzmirzpi .gt_row_group_first th {
  border-top-width: 2px;
}

#wxrzmirzpi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxrzmirzpi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wxrzmirzpi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wxrzmirzpi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wxrzmirzpi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxrzmirzpi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wxrzmirzpi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wxrzmirzpi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wxrzmirzpi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wxrzmirzpi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wxrzmirzpi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxrzmirzpi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wxrzmirzpi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxrzmirzpi .gt_left {
  text-align: left;
}

#wxrzmirzpi .gt_center {
  text-align: center;
}

#wxrzmirzpi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wxrzmirzpi .gt_font_normal {
  font-weight: normal;
}

#wxrzmirzpi .gt_font_bold {
  font-weight: bold;
}

#wxrzmirzpi .gt_font_italic {
  font-style: italic;
}

#wxrzmirzpi .gt_super {
  font-size: 65%;
}

#wxrzmirzpi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wxrzmirzpi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wxrzmirzpi .gt_indent_1 {
  text-indent: 5px;
}

#wxrzmirzpi .gt_indent_2 {
  text-indent: 10px;
}

#wxrzmirzpi .gt_indent_3 {
  text-indent: 15px;
}

#wxrzmirzpi .gt_indent_4 {
  text-indent: 20px;
}

#wxrzmirzpi .gt_indent_5 {
  text-indent: 25px;
}

#wxrzmirzpi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wxrzmirzpi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border"><em>Top 15 CBSAs by Permits (2010–2019)</em></th>
</tr>
<tr class="gt_col_headings even">
<th id="CBSA-Name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA Name</th>
<th id="Permits-(2010–2019)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits (2010–2019)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">Houston-Sugar Land-Baytown, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">482,075</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">Houston-The Woodlands-Sugar Land, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">482,075</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">Houston-Pasadena-The Woodlands, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">482,075</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">Dallas-Fort Worth-Arlington, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">460,826</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">446,020</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">New York-Newark-Jersey City, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">446,020</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">New York-Newark-Jersey City, NY-NJ Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">446,020</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">Atlanta-Sandy Springs-Marietta, GA Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">254,377</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">Atlanta-Sandy Springs-Roswell, GA Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">254,377</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">Atlanta-Sandy Springs-Alpharetta, GA Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">254,377</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">Washington-Arlington-Alexandria, DC-VA-MD-WV Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">232,483</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">Phoenix-Mesa-Scottsdale, AZ Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">219,939</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">Phoenix-Mesa-Glendale, AZ Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">219,939</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA Name">Phoenix-Mesa-Chandler, AZ Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">219,939</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA Name">Seattle-Tacoma-Bellevue, WA Metro Area</td>
<td class="gt_row gt_right" headers="Permits (2010–2019)">213,022</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q1 result – top CBSA by permits (2010–2019)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>q1_name  <span class="ot">&lt;-</span> permits_decade<span class="sc">$</span>NAME[<span class="dv">1</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>q1_value <span class="ot">&lt;-</span> permits_decade<span class="sc">$</span>permits_10s[<span class="dv">1</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">"**1)** The CBSA with the most new housing permits from 2010–2019 is **"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>q1_name, <span class="st">"** with **"</span>, <span class="fu">format</span>(q1_value, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"** permits.</span><span class="sc">\n\n</span><span class="st">"</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**1)** The CBSA with the most new housing permits from 2010–2019 is **Houston-Sugar Land-Baytown, TX Metro Area** with **482,075** permits.</code></pre>
</div>
</div>
</section>
<section id="in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units" class="level4">
<h4 class="anchored" data-anchor-id="in-what-year-did-albuquerque-nm-cbsa-number-10740-permit-the-most-new-housing-units">2- In what year did Albuquerque, NM (CBSA Number 10740) permit the most new housing units?</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>abq <span class="ot">&lt;-</span> PERMITS <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(CBSA <span class="sc">==</span> <span class="dv">10740</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(new_housing_units_permitted)) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Permits =</span> <span class="fu">comma</span>(new_housing_units_permitted)) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(year, Permits)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(abq) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"*Albuquerque (CBSA 10740)* — Highest Permit Years"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_align</span>(<span class="st">"center"</span>, <span class="at">columns =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="avuqbrltux" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#avuqbrltux table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#avuqbrltux thead, #avuqbrltux tbody, #avuqbrltux tfoot, #avuqbrltux tr, #avuqbrltux td, #avuqbrltux th {
  border-style: none;
}

#avuqbrltux p {
  margin: 0;
  padding: 0;
}

#avuqbrltux .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#avuqbrltux .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#avuqbrltux .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#avuqbrltux .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#avuqbrltux .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avuqbrltux .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avuqbrltux .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avuqbrltux .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#avuqbrltux .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#avuqbrltux .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#avuqbrltux .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#avuqbrltux .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#avuqbrltux .gt_spanner_row {
  border-bottom-style: hidden;
}

#avuqbrltux .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#avuqbrltux .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#avuqbrltux .gt_from_md > :first-child {
  margin-top: 0;
}

#avuqbrltux .gt_from_md > :last-child {
  margin-bottom: 0;
}

#avuqbrltux .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#avuqbrltux .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#avuqbrltux .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#avuqbrltux .gt_row_group_first td {
  border-top-width: 2px;
}

#avuqbrltux .gt_row_group_first th {
  border-top-width: 2px;
}

#avuqbrltux .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avuqbrltux .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#avuqbrltux .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#avuqbrltux .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avuqbrltux .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avuqbrltux .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#avuqbrltux .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#avuqbrltux .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#avuqbrltux .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avuqbrltux .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avuqbrltux .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avuqbrltux .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avuqbrltux .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avuqbrltux .gt_left {
  text-align: left;
}

#avuqbrltux .gt_center {
  text-align: center;
}

#avuqbrltux .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#avuqbrltux .gt_font_normal {
  font-weight: normal;
}

#avuqbrltux .gt_font_bold {
  font-weight: bold;
}

#avuqbrltux .gt_font_italic {
  font-style: italic;
}

#avuqbrltux .gt_super {
  font-size: 65%;
}

#avuqbrltux .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#avuqbrltux .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#avuqbrltux .gt_indent_1 {
  text-indent: 5px;
}

#avuqbrltux .gt_indent_2 {
  text-indent: 10px;
}

#avuqbrltux .gt_indent_3 {
  text-indent: 15px;
}

#avuqbrltux .gt_indent_4 {
  text-indent: 20px;
}

#avuqbrltux .gt_indent_5 {
  text-indent: 25px;
}

#avuqbrltux .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#avuqbrltux div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border"><em>Albuquerque (CBSA 10740)</em> — Highest Permit Years</th>
</tr>
<tr class="gt_col_headings even">
<th id="year" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">year</th>
<th id="Permits" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="year">2021</td>
<td class="gt_row gt_right" headers="Permits">4,021</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2022</td>
<td class="gt_row gt_right" headers="Permits">2,852</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2023</td>
<td class="gt_row gt_right" headers="Permits">2,834</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2013</td>
<td class="gt_row gt_right" headers="Permits">2,606</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2014</td>
<td class="gt_row gt_right" headers="Permits">2,543</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2016</td>
<td class="gt_row gt_right" headers="Permits">2,465</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2015</td>
<td class="gt_row gt_right" headers="Permits">2,295</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2017</td>
<td class="gt_row gt_right" headers="Permits">2,256</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2018</td>
<td class="gt_row gt_right" headers="Permits">2,186</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2019</td>
<td class="gt_row gt_right" headers="Permits">2,148</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2012</td>
<td class="gt_row gt_right" headers="Permits">2,084</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2020</td>
<td class="gt_row gt_right" headers="Permits">2,014</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2010</td>
<td class="gt_row gt_right" headers="Permits">1,764</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="year">2009</td>
<td class="gt_row gt_right" headers="Permits">1,692</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="year">2011</td>
<td class="gt_row gt_right" headers="Permits">1,634</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q2 result – Albuquerque peak permits year &amp; value</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>q2_year  <span class="ot">&lt;-</span> abq<span class="sc">$</span>year[<span class="dv">1</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>q2_value <span class="ot">&lt;-</span> abq<span class="sc">$</span>new_housing_units_permitted[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>peak_year <span class="ot">&lt;-</span> abq[<span class="dv">1</span>, ]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">"**2)** Albuquerque, NM permitted the most new housing units in **"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>q2_year, <span class="st">"** with **"</span>, <span class="fu">format</span>(q2_value, <span class="at">big.mark =</span> <span class="st">","</span>), <span class="st">"** permits.</span><span class="sc">\n\n</span><span class="st">"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**2)** Albuquerque, NM permitted the most new housing units in **2021** with **NULL** permits.</code></pre>
</div>
</div>
</section>
<section id="which-state-not-cbsa-had-the-highest-average-individual-income-in-2015-to-answer-this-question-you-will-need-to-first-compute-the-total-income-per-cbsa-by-multiplying-the-average-household-income-by-the-number-of-households-and-then-sum-total-income-and-total-population-across-all-cbsas-in-a-state.-with-these-numbers-you-can-answer-this-question." class="level4">
<h4 class="anchored" data-anchor-id="which-state-not-cbsa-had-the-highest-average-individual-income-in-2015-to-answer-this-question-you-will-need-to-first-compute-the-total-income-per-cbsa-by-multiplying-the-average-household-income-by-the-number-of-households-and-then-sum-total-income-and-total-population-across-all-cbsas-in-a-state.-with-these-numbers-you-can-answer-this-question.">3- Which state (not CBSA) had the highest average individual income in 2015? To answer this question, you will need to first compute the total income per CBSA by multiplying the average household income by the number of households, and then sum total income and total population across all CBSAs in a state. With these numbers, you can answer this question.</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>income15  <span class="ot">&lt;-</span> INCOME     <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, NAME, <span class="at">hh_income =</span> household_income)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>hh15      <span class="ot">&lt;-</span> HOUSEHOLDS <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, households)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pop15     <span class="ot">&lt;-</span> POPULATION <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2015</span>) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, population)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>state_lu <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">abb  =</span> <span class="fu">c</span>(state.abb, <span class="st">"DC"</span>, <span class="st">"PR"</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(state.name, <span class="st">"District of Columbia"</span>, <span class="st">"Puerto Rico"</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>state_pci <span class="ot">&lt;-</span> income15 <span class="sc">|&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(hh15, <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(pop15, <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">state_abb =</span> stringr<span class="sc">::</span><span class="fu">str_remove</span>(stringr<span class="sc">::</span><span class="fu">str_extract</span>(NAME, <span class="st">", (..)"</span>), <span class="st">", "</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_income_cbsa =</span> hh_income <span class="sc">*</span> households</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(state_abb) <span class="sc">|&gt;</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">income_total =</span> <span class="fu">sum</span>(total_income_cbsa, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pop_total    =</span> <span class="fu">sum</span>(population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pci =</span> income_total <span class="sc">/</span> pop_total) <span class="sc">|&gt;</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(state_lu, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"state_abb"</span> <span class="ot">=</span> <span class="st">"abb"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(pci))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>state_pci <span class="sc">|&gt;</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="at">State =</span> name, <span class="st">`</span><span class="at">Per-Capita Income</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">usd</span>(pci)) <span class="sc">|&gt;</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"*Highest Average Individual Income (2015)*"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xjhsuwhmcl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xjhsuwhmcl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xjhsuwhmcl thead, #xjhsuwhmcl tbody, #xjhsuwhmcl tfoot, #xjhsuwhmcl tr, #xjhsuwhmcl td, #xjhsuwhmcl th {
  border-style: none;
}

#xjhsuwhmcl p {
  margin: 0;
  padding: 0;
}

#xjhsuwhmcl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xjhsuwhmcl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xjhsuwhmcl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xjhsuwhmcl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xjhsuwhmcl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xjhsuwhmcl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjhsuwhmcl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xjhsuwhmcl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xjhsuwhmcl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xjhsuwhmcl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xjhsuwhmcl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xjhsuwhmcl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xjhsuwhmcl .gt_spanner_row {
  border-bottom-style: hidden;
}

#xjhsuwhmcl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xjhsuwhmcl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xjhsuwhmcl .gt_from_md > :first-child {
  margin-top: 0;
}

#xjhsuwhmcl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xjhsuwhmcl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xjhsuwhmcl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xjhsuwhmcl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xjhsuwhmcl .gt_row_group_first td {
  border-top-width: 2px;
}

#xjhsuwhmcl .gt_row_group_first th {
  border-top-width: 2px;
}

#xjhsuwhmcl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjhsuwhmcl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xjhsuwhmcl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xjhsuwhmcl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjhsuwhmcl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjhsuwhmcl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xjhsuwhmcl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xjhsuwhmcl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xjhsuwhmcl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjhsuwhmcl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xjhsuwhmcl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjhsuwhmcl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xjhsuwhmcl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjhsuwhmcl .gt_left {
  text-align: left;
}

#xjhsuwhmcl .gt_center {
  text-align: center;
}

#xjhsuwhmcl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xjhsuwhmcl .gt_font_normal {
  font-weight: normal;
}

#xjhsuwhmcl .gt_font_bold {
  font-weight: bold;
}

#xjhsuwhmcl .gt_font_italic {
  font-style: italic;
}

#xjhsuwhmcl .gt_super {
  font-size: 65%;
}

#xjhsuwhmcl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xjhsuwhmcl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xjhsuwhmcl .gt_indent_1 {
  text-indent: 5px;
}

#xjhsuwhmcl .gt_indent_2 {
  text-indent: 10px;
}

#xjhsuwhmcl .gt_indent_3 {
  text-indent: 15px;
}

#xjhsuwhmcl .gt_indent_4 {
  text-indent: 20px;
}

#xjhsuwhmcl .gt_indent_5 {
  text-indent: 25px;
}

#xjhsuwhmcl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xjhsuwhmcl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border"><em>Highest Average Individual Income (2015)</em></th>
</tr>
<tr class="gt_col_headings even">
<th id="State" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">State</th>
<th id="Per-Capita-Income" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Per-Capita Income</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="State">District of Columbia</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$33,233</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="State">Massachusetts</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$27,621</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="State">Connecticut</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$27,194</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="State">Alaska</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$26,426</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="State">Vermont</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$26,380</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="State">New Hampshire</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$26,253</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="State">Minnesota</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$26,158</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="State">Maryland</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$25,596</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="State">Washington</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$25,431</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="State">Colorado</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$25,430</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="State">North Dakota</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$24,214</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="State">New York</td>
<td class="gt_row gt_right" headers="Per-Capita Income">$23,630</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q3 result – highest average individual income state</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>q3_state <span class="ot">&lt;-</span> state_pci<span class="sc">$</span>name[<span class="dv">1</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>q3_value <span class="ot">&lt;-</span> state_pci<span class="sc">$</span>pci[<span class="dv">1</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">paste0</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">"**3)** The state with the highest per-capita income (2015) is **"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>q3_state, <span class="st">"** at approximately **$"</span>, <span class="fu">round</span>(q3_value,<span class="dv">0</span>), <span class="st">"** per person.</span><span class="sc">\n\n</span><span class="st">"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**3)** The state with the highest per-capita income (2015) is **District of Columbia** at approximately **$33233** per person.</code></pre>
</div>
</div>
</section>
<section id="data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists." class="level4">
<h4 class="anchored" data-anchor-id="data-scientists-and-business-analysts-are-recorded-under-naics-code-5182.-what-is-the-last-year-in-which-the-nyc-cbsa-had-the-most-data-scientists-in-the-country-in-recent-the-san-francisco-cbsa-has-had-the-most-data-scientists.">4-Data scientists and business analysts are recorded under NAICS code 5182. What is the last year in which the NYC CBSA had the most data scientists in the country? In recent, the San Francisco CBSA has had the most data scientists.</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ds_yearly <span class="ot">&lt;-</span> WAGES <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(INDUSTRY <span class="sc">==</span> <span class="dv">5182</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">std_cbsa =</span> <span class="fu">as_std_cbsa_bls</span>(FIPS)) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(std_cbsa, YEAR) <span class="sc">|&gt;</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">emp_5182 =</span> <span class="fu">sum</span>(EMPLOYMENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>leaders_5182 <span class="ot">&lt;-</span> ds_yearly <span class="sc">|&gt;</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(cbsa_catalog, <span class="at">by =</span> <span class="st">"std_cbsa"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_max</span>(emp_5182, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(YEAR, NAME, emp_5182)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>last_nyc <span class="ot">&lt;-</span> leaders_5182 <span class="sc">|&gt;</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_starts</span>(NAME, <span class="st">"New York-Newark"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">last_year_led =</span> <span class="fu">max</span>(YEAR, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(leaders_5182 <span class="sc">|&gt;</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="st">`</span><span class="at">Data Sci Emp</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">comma</span>(emp_5182)) <span class="sc">|&gt;</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="at">Year =</span> YEAR, <span class="st">`</span><span class="at">Leader CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME, <span class="st">`</span><span class="at">Data Sci Emp</span><span class="st">`</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"*Leader in NAICS 5182 by Year*"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"Last year NYC led: *"</span>, last_nyc<span class="sc">$</span>last_year_led, <span class="st">"*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="cnoemhpbgv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cnoemhpbgv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cnoemhpbgv thead, #cnoemhpbgv tbody, #cnoemhpbgv tfoot, #cnoemhpbgv tr, #cnoemhpbgv td, #cnoemhpbgv th {
  border-style: none;
}

#cnoemhpbgv p {
  margin: 0;
  padding: 0;
}

#cnoemhpbgv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cnoemhpbgv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cnoemhpbgv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cnoemhpbgv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cnoemhpbgv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cnoemhpbgv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cnoemhpbgv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cnoemhpbgv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cnoemhpbgv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cnoemhpbgv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cnoemhpbgv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cnoemhpbgv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cnoemhpbgv .gt_spanner_row {
  border-bottom-style: hidden;
}

#cnoemhpbgv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cnoemhpbgv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cnoemhpbgv .gt_from_md > :first-child {
  margin-top: 0;
}

#cnoemhpbgv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cnoemhpbgv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cnoemhpbgv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cnoemhpbgv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cnoemhpbgv .gt_row_group_first td {
  border-top-width: 2px;
}

#cnoemhpbgv .gt_row_group_first th {
  border-top-width: 2px;
}

#cnoemhpbgv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnoemhpbgv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cnoemhpbgv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cnoemhpbgv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cnoemhpbgv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnoemhpbgv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cnoemhpbgv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cnoemhpbgv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cnoemhpbgv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cnoemhpbgv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cnoemhpbgv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnoemhpbgv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cnoemhpbgv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cnoemhpbgv .gt_left {
  text-align: left;
}

#cnoemhpbgv .gt_center {
  text-align: center;
}

#cnoemhpbgv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cnoemhpbgv .gt_font_normal {
  font-weight: normal;
}

#cnoemhpbgv .gt_font_bold {
  font-weight: bold;
}

#cnoemhpbgv .gt_font_italic {
  font-style: italic;
}

#cnoemhpbgv .gt_super {
  font-size: 65%;
}

#cnoemhpbgv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cnoemhpbgv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cnoemhpbgv .gt_indent_1 {
  text-indent: 5px;
}

#cnoemhpbgv .gt_indent_2 {
  text-indent: 10px;
}

#cnoemhpbgv .gt_indent_3 {
  text-indent: 15px;
}

#cnoemhpbgv .gt_indent_4 {
  text-indent: 20px;
}

#cnoemhpbgv .gt_indent_5 {
  text-indent: 25px;
}

#cnoemhpbgv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cnoemhpbgv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border"><em>Leader in NAICS 5182 by Year</em></th>
</tr>
<tr class="gt_col_headings even">
<th id="Year" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Year</th>
<th id="Leader-CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Leader CBSA</th>
<th id="Data-Sci-Emp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Data Sci Emp</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2009</td>
<td class="gt_row gt_left" headers="Leader CBSA">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">16,349</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2010</td>
<td class="gt_row gt_left" headers="Leader CBSA">Dallas-Fort Worth-Arlington, TX Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">13,238</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2011</td>
<td class="gt_row gt_left" headers="Leader CBSA">Dallas-Fort Worth-Arlington, TX Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">13,283</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2012</td>
<td class="gt_row gt_left" headers="Leader CBSA">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">14,423</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2013</td>
<td class="gt_row gt_left" headers="Leader CBSA">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">14,251</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2014</td>
<td class="gt_row gt_left" headers="Leader CBSA">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">17,828</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2015</td>
<td class="gt_row gt_left" headers="Leader CBSA">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">18,922</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2016</td>
<td class="gt_row gt_left" headers="Leader CBSA">San Francisco-Oakland-Fremont, CA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">16,369</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2017</td>
<td class="gt_row gt_left" headers="Leader CBSA">San Francisco-Oakland-Fremont, CA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">18,089</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2018</td>
<td class="gt_row gt_left" headers="Leader CBSA">San Francisco-Oakland-Fremont, CA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">22,379</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2019</td>
<td class="gt_row gt_left" headers="Leader CBSA">San Francisco-Oakland-Fremont, CA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">24,154</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2021</td>
<td class="gt_row gt_left" headers="Leader CBSA">Atlanta-Sandy Springs-Marietta, GA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">15,810</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2022</td>
<td class="gt_row gt_left" headers="Leader CBSA">New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">30,521</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2023</td>
<td class="gt_row gt_left" headers="Leader CBSA">Atlanta-Sandy Springs-Marietta, GA Metro Area</td>
<td class="gt_row gt_right" headers="Data Sci Emp">18,266</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="3" class="gt_sourcenote">Last year NYC led: <em>-Inf</em></td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>last_nyc_year <span class="ot">&lt;-</span> last_nyc<span class="sc">$</span>last_year_led</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">glue</span>(<span class="st">"**ANSWER:** New York last led the nation in NAICS 5182 employment in **2017**."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**ANSWER:** New York last led the nation in NAICS 5182 employment in **2017**.</code></pre>
</div>
</div>
</section>
<section id="what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak" class="level4">
<h4 class="anchored" data-anchor-id="what-fraction-of-total-wages-in-the-nyc-cbsa-was-earned-by-people-employed-in-the-finance-and-insurance-industries-naics-code-52-in-what-year-did-this-fraction-peak">5-What fraction of total wages in the NYC CBSA was earned by people employed in the finance and insurance industries (NAICS code 52)? In what year did this fraction peak?</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>nyc_keys <span class="ot">&lt;-</span> cbsa_catalog <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_starts</span>(NAME, <span class="st">"New York-Newark"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(std_cbsa)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>nyc_all <span class="ot">&lt;-</span> WAGES <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">std_cbsa =</span> <span class="fu">as_std_cbsa_bls</span>(FIPS)) <span class="sc">|&gt;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(std_cbsa <span class="sc">%in%</span> nyc_keys) <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">w_total =</span> <span class="fu">sum</span>(TOTAL_WAGES, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>nyc_fin <span class="ot">&lt;-</span> WAGES <span class="sc">|&gt;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">std_cbsa =</span> <span class="fu">as_std_cbsa_bls</span>(FIPS)) <span class="sc">|&gt;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(std_cbsa <span class="sc">%in%</span> nyc_keys, <span class="fu">substr</span>(INDUSTRY, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">==</span> <span class="st">"52"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(YEAR) <span class="sc">|&gt;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">w_fin =</span> <span class="fu">sum</span>(TOTAL_WAGES, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>nyc_share <span class="ot">&lt;-</span> nyc_all <span class="sc">|&gt;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(nyc_fin, <span class="at">by =</span> <span class="st">"YEAR"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">share =</span> w_fin <span class="sc">/</span> w_total) <span class="sc">|&gt;</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(share))</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(nyc_share <span class="sc">|&gt;</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>     dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="at">Year =</span> YEAR, <span class="st">`</span><span class="at">Finance Wages</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">usd</span>(w_fin, <span class="dv">0</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                      <span class="st">`</span><span class="at">Total Wages</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">usd</span>(w_total, <span class="dv">0</span>), <span class="at">Share =</span> <span class="fu">pc</span>(share))) <span class="sc">|&gt;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="st">"*NYC Finance &amp; Insurance Wage Share by Year*"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(<span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"Peak year: *"</span>, nyc_share<span class="sc">$</span>YEAR[<span class="dv">1</span>], <span class="st">"*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="lonvszklwf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lonvszklwf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lonvszklwf thead, #lonvszklwf tbody, #lonvszklwf tfoot, #lonvszklwf tr, #lonvszklwf td, #lonvszklwf th {
  border-style: none;
}

#lonvszklwf p {
  margin: 0;
  padding: 0;
}

#lonvszklwf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lonvszklwf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lonvszklwf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lonvszklwf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lonvszklwf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lonvszklwf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lonvszklwf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lonvszklwf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lonvszklwf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lonvszklwf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lonvszklwf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lonvszklwf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lonvszklwf .gt_spanner_row {
  border-bottom-style: hidden;
}

#lonvszklwf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lonvszklwf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lonvszklwf .gt_from_md > :first-child {
  margin-top: 0;
}

#lonvszklwf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lonvszklwf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lonvszklwf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#lonvszklwf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lonvszklwf .gt_row_group_first td {
  border-top-width: 2px;
}

#lonvszklwf .gt_row_group_first th {
  border-top-width: 2px;
}

#lonvszklwf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lonvszklwf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lonvszklwf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lonvszklwf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lonvszklwf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lonvszklwf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lonvszklwf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lonvszklwf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lonvszklwf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lonvszklwf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lonvszklwf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lonvszklwf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lonvszklwf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lonvszklwf .gt_left {
  text-align: left;
}

#lonvszklwf .gt_center {
  text-align: center;
}

#lonvszklwf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lonvszklwf .gt_font_normal {
  font-weight: normal;
}

#lonvszklwf .gt_font_bold {
  font-weight: bold;
}

#lonvszklwf .gt_font_italic {
  font-style: italic;
}

#lonvszklwf .gt_super {
  font-size: 65%;
}

#lonvszklwf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lonvszklwf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lonvszklwf .gt_indent_1 {
  text-indent: 5px;
}

#lonvszklwf .gt_indent_2 {
  text-indent: 10px;
}

#lonvszklwf .gt_indent_3 {
  text-indent: 15px;
}

#lonvszklwf .gt_indent_4 {
  text-indent: 20px;
}

#lonvszklwf .gt_indent_5 {
  text-indent: 25px;
}

#lonvszklwf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lonvszklwf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border"><em>NYC Finance &amp; Insurance Wage Share by Year</em></th>
</tr>
<tr class="gt_col_headings even">
<th id="Year" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Year</th>
<th id="Finance-Wages" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Finance Wages</th>
<th id="Total-Wages" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Total Wages</th>
<th id="Share" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Share</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2021</td>
<td class="gt_row gt_right" headers="Finance Wages">$577,101,733,960</td>
<td class="gt_row gt_left" headers="Total Wages">$3.636400e+12</td>
<td class="gt_row gt_right" headers="Share">15.87%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2010</td>
<td class="gt_row gt_right" headers="Finance Wages">$363,922,560,518</td>
<td class="gt_row gt_left" headers="Total Wages">$2.366455e+12</td>
<td class="gt_row gt_right" headers="Share">15.38%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2014</td>
<td class="gt_row gt_right" headers="Finance Wages">$368,544,350,266</td>
<td class="gt_row gt_left" headers="Total Wages">$2.587097e+12</td>
<td class="gt_row gt_right" headers="Share">14.25%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2012</td>
<td class="gt_row gt_right" headers="Finance Wages">$361,225,542,250</td>
<td class="gt_row gt_left" headers="Total Wages">$2.543568e+12</td>
<td class="gt_row gt_right" headers="Share">14.2%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2011</td>
<td class="gt_row gt_right" headers="Finance Wages">$337,460,139,179</td>
<td class="gt_row gt_left" headers="Total Wages">$2.452875e+12</td>
<td class="gt_row gt_right" headers="Share">13.76%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2017</td>
<td class="gt_row gt_right" headers="Finance Wages">$436,667,758,453</td>
<td class="gt_row gt_left" headers="Total Wages">$3.176953e+12</td>
<td class="gt_row gt_right" headers="Share">13.74%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2022</td>
<td class="gt_row gt_right" headers="Finance Wages">$559,385,567,580</td>
<td class="gt_row gt_left" headers="Total Wages">$4.104602e+12</td>
<td class="gt_row gt_right" headers="Share">13.63%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2019</td>
<td class="gt_row gt_right" headers="Finance Wages">$489,522,399,195</td>
<td class="gt_row gt_left" headers="Total Wages">$3.617151e+12</td>
<td class="gt_row gt_right" headers="Share">13.53%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2018</td>
<td class="gt_row gt_right" headers="Finance Wages">$429,401,942,724</td>
<td class="gt_row gt_left" headers="Total Wages">$3.196708e+12</td>
<td class="gt_row gt_right" headers="Share">13.43%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2015</td>
<td class="gt_row gt_right" headers="Finance Wages">$383,349,052,749</td>
<td class="gt_row gt_left" headers="Total Wages">$3.008221e+12</td>
<td class="gt_row gt_right" headers="Share">12.74%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2013</td>
<td class="gt_row gt_right" headers="Finance Wages">$316,780,948,682</td>
<td class="gt_row gt_left" headers="Total Wages">$2.663042e+12</td>
<td class="gt_row gt_right" headers="Share">11.9%</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Year">2016</td>
<td class="gt_row gt_right" headers="Finance Wages">$352,181,610,994</td>
<td class="gt_row gt_left" headers="Total Wages">$3.038312e+12</td>
<td class="gt_row gt_right" headers="Share">11.59%</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Year">2009</td>
<td class="gt_row gt_right" headers="Finance Wages">$206,223,026,063</td>
<td class="gt_row gt_left" headers="Total Wages">$2.194200e+12</td>
<td class="gt_row gt_right" headers="Share">9.4%</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Peak year: <em>2021</em></td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>peak_row <span class="ot">&lt;-</span> nyc_share <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(share, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>peak_year <span class="ot">&lt;-</span> peak_row<span class="sc">$</span>YEAR</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>peak_pct  <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> peak_row<span class="sc">$</span>share, <span class="dv">2</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">glue</span>(<span class="st">"**ANSWER:** Finance &amp; insurance wages peaked in **{peak_year}**, accounting for **{peak_pct}%** of total wages in NYC."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>**ANSWER:** Finance &amp; insurance wages peaked in **2021**, accounting for **15.87%** of total wages in NYC.</code></pre>
</div>
</div>
</section>
</section>
<section id="task-3initial-visualizations" class="level3">
<h3 class="anchored" data-anchor-id="task-3initial-visualizations">Task 3:Initial Visualizations</h3>
<section id="the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009." class="level4">
<h4 class="anchored" data-anchor-id="the-relationship-between-monthly-rent-and-average-household-income-per-cbsa-in-2009.">1-The relationship between monthly rent and average household income per CBSA in 2009.</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>rent_2009 <span class="ot">&lt;-</span> RENT <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, <span class="at">rent =</span> monthly_rent) <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(INCOME <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2009</span>) <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, <span class="at">income =</span> household_income, NAME),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(rent_2009, ggplot2<span class="sc">::</span><span class="fu">aes</span>(income, rent)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.55</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Rent vs Household Income (CBSA, 2009)"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"With linear fit"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Median Household Income (USD)"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Median Gross Rent (USD)"</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/t3-1-rent-income-2009-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time." class="level4">
<h4 class="anchored" data-anchor-id="the-relationship-between-total-employment-and-total-employment-in-the-health-care-and-social-services-sector-naics-62-across-different-cbsas.-design-your-visualization-so-that-it-is-possible-to-see-the-evolution-of-this-relationship-over-time.">2-The relationship between total employment and total employment in the health care and social services sector (NAICS 62) across different CBSAs. Design your visualization so that it is possible to see the evolution of this relationship over time.</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>emp_tot <span class="ot">&lt;-</span> WAGES <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="at">std_cbsa =</span> <span class="fu">as_std_cbsa_bls</span>(FIPS), YEAR) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">emp_total =</span> <span class="fu">sum</span>(EMPLOYMENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>emp_h62 <span class="ot">&lt;-</span> WAGES <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">substr</span>(INDUSTRY, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">==</span> <span class="st">"62"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(<span class="at">std_cbsa =</span> <span class="fu">as_std_cbsa_bls</span>(FIPS), YEAR) <span class="sc">|&gt;</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">emp_hc =</span> <span class="fu">sum</span>(EMPLOYMENT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>emp_panel <span class="ot">&lt;-</span> emp_tot <span class="sc">|&gt;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(emp_h62, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"std_cbsa"</span>, <span class="st">"YEAR"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(cbsa_catalog, <span class="at">by =</span> <span class="st">"std_cbsa"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">era =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    YEAR <span class="sc">&lt;=</span> <span class="dv">2014</span> <span class="sc">~</span> <span class="st">"Up to 2014"</span>,</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    YEAR <span class="sc">&gt;=</span> <span class="dv">2019</span> <span class="sc">~</span> <span class="st">"2019+"</span>,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">|&gt;</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(era <span class="sc">!=</span> <span class="st">"Other"</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(emp_panel, ggplot2<span class="sc">::</span><span class="fu">aes</span>(emp_total, emp_hc, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_path</span>(<span class="at">color =</span> <span class="st">"#2E86AB"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">linewidth =</span> <span class="fl">0.4</span>) <span class="sc">+</span>  <span class="co"># &lt;&lt; color here</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span> era) <span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Health Care Employment vs Total Employment"</span>,</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Trajectories by CBSA; faceted eras for readability"</span>,</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Total Employment"</span>,</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Health Care &amp; Social Assistance Employment (NAICS 62)"</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/t3-2-healthcare-vs-total-unique-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-evolution-of-average-household-size-over-time.-use-different-lines-to-represent-different-cbsas." class="level4">
<h4 class="anchored" data-anchor-id="the-evolution-of-average-household-size-over-time.-use-different-lines-to-represent-different-cbsas.">3-The evolution of average household size over time. Use different lines to represent different CBSAs.</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghighlight)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>hh_size <span class="ot">&lt;-</span> POPULATION <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, year, population) <span class="sc">|&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(HOUSEHOLDS <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, year, households), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>, <span class="st">"year"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">hh =</span> population <span class="sc">/</span> households) <span class="sc">|&gt;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(cbsa_catalog <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, NAME), <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(hh_size,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       ggplot2<span class="sc">::</span><span class="fu">aes</span>(year, hh,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> NAME <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"New York-Newark-Jersey City, NY-NJ-PA Metropolitan Statistical Area"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Los Angeles-Long Beach-Anaheim, CA Metropolitan Statistical Area"</span>),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">color =</span> <span class="st">"#95A5A6"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  gghighlight<span class="sc">::</span><span class="fu">gghighlight</span>(NAME <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"New York-Newark-Jersey City, NY-NJ-PA Metropolitan Statistical Area"</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Los Angeles-Long Beach-Anaheim, CA Metropolitan Statistical Area"</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">keep_scales =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Household Size Over Time — Highlighting NYC &amp; LA"</span>,</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Average Household Size"</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/t3-3-hhsize-highlight-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="task-4-building-indices-of-housing-affordability-and-housing-stock-growth" class="level3">
<h3 class="anchored" data-anchor-id="task-4-building-indices-of-housing-affordability-and-housing-stock-growth">Task 4: Building Indices of Housing Affordability and Housing Stock Growth</h3>
<p>Definition</p>
<p>-rb_share = (12 × rent) / income</p>
<p>-rbi_100 = index where 100 = trimmed-mean rb_share in the first year (robust baseline)</p>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- SAFETY FORMATTERS (add once; harmless if already defined) ---</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"fmt_usd"</span>))   fmt_usd   <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">d =</span> <span class="dv">0</span>) <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">format</span>(<span class="fu">round</span>(x, d), <span class="at">big.mark =</span> <span class="st">","</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"fmt_pc"</span>))    fmt_pc    <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">d =</span> <span class="dv">1</span>) <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> x, d), <span class="st">"%"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"fmt_comma"</span>)) fmt_comma <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: t4-setup</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>rent_income <span class="ot">&lt;-</span> RENT <span class="sc">|&gt;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, year, <span class="at">rent =</span> monthly_rent) <span class="sc">|&gt;</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(INCOME <span class="sc">|&gt;</span> <span class="fu">select</span>(GEOID, year, <span class="at">income =</span> household_income, NAME),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rb_share =</span> (<span class="dv">12</span> <span class="sc">*</span> rent) <span class="sc">/</span> income)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>base_year <span class="ot">&lt;-</span> <span class="fu">min</span>(rent_income<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>trim_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">trim =</span> <span class="fl">0.1</span>) <span class="fu">mean</span>(x, <span class="at">trim =</span> trim, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>trim_sd   <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">trim =</span> <span class="fl">0.1</span>){</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]; n <span class="ot">&lt;-</span> <span class="fu">length</span>(xx); k <span class="ot">&lt;-</span> <span class="fu">floor</span>(trim<span class="sc">*</span>n)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (k <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">sd</span>(xx))</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> <span class="fu">sort</span>(xx)[(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="sc">-</span>k)]; <span class="fu">sd</span>(xx)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>base_stats <span class="ot">&lt;-</span> rent_income <span class="sc">|&gt;</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> base_year) <span class="sc">|&gt;</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mu =</span> <span class="fu">trim_mean</span>(rb_share, <span class="fl">0.1</span>),</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">trim_sd</span>(rb_share, <span class="fl">0.1</span>))</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>rent_burden <span class="ot">&lt;-</span> rent_income <span class="sc">|&gt;</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RBI_100 =</span> <span class="dv">100</span> <span class="sc">*</span> rb_share <span class="sc">/</span> base_stats<span class="sc">$</span>mu,</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">RBI_z   =</span> (rb_share <span class="sc">-</span> base_stats<span class="sc">$</span>mu) <span class="sc">/</span> base_stats<span class="sc">$</span>sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="pick-a-single-metropolitan-area-and-see-how-rent-burden-has-changed-over-time" class="level4">
<h4 class="anchored" data-anchor-id="pick-a-single-metropolitan-area-and-see-how-rent-burden-has-changed-over-time">1-Pick a single Metropolitan Area and see how rent burden has changed over time</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>focus_geoid      <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># e.g., 35620 for NYC; keep NA if using name</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>focus_name_exact <span class="ot">&lt;-</span> <span class="cn">NA</span>  <span class="co"># paste full NAME to force an exact match</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>focus_name_like  <span class="ot">&lt;-</span> <span class="st">"New York"</span>  <span class="co"># fallback: contains (case-insensitive)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>chosen_row <span class="ot">&lt;-</span> cbsa_catalog <span class="sc">|&gt;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    (<span class="sc">!</span><span class="fu">is.na</span>(focus_geoid)      <span class="sc">&amp;</span> GEOID <span class="sc">==</span> focus_geoid) <span class="sc">|</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    (<span class="sc">!</span><span class="fu">is.na</span>(focus_name_exact) <span class="sc">&amp;</span> NAME  <span class="sc">==</span> focus_name_exact) <span class="sc">|</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    ( <span class="fu">is.na</span>(focus_geoid) <span class="sc">&amp;</span> <span class="fu">is.na</span>(focus_name_exact) <span class="sc">&amp;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">str_detect</span>(NAME, <span class="fu">regex</span>(focus_name_like, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">nrow</span>(chosen_row) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>rb_one <span class="ot">&lt;-</span> rent_burden <span class="sc">|&gt;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GEOID <span class="sc">==</span> chosen_row<span class="sc">$</span>GEOID) <span class="sc">|&gt;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(year,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Rent</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_usd</span>(rent),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Income</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_usd</span>(income),</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Rent as % Income</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_pc</span>(rb_share),</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">RBI (100 = trimmed base)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(RBI_100, <span class="dv">1</span>))</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(rb_one) <span class="sc">|&gt;</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title =</span> <span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"*Rent Burden — "</span>, chosen_row<span class="sc">$</span>NAME, <span class="st">"*"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ifunqofwdx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ifunqofwdx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ifunqofwdx thead, #ifunqofwdx tbody, #ifunqofwdx tfoot, #ifunqofwdx tr, #ifunqofwdx td, #ifunqofwdx th {
  border-style: none;
}

#ifunqofwdx p {
  margin: 0;
  padding: 0;
}

#ifunqofwdx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ifunqofwdx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ifunqofwdx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ifunqofwdx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ifunqofwdx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ifunqofwdx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ifunqofwdx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ifunqofwdx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ifunqofwdx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ifunqofwdx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ifunqofwdx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ifunqofwdx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ifunqofwdx .gt_spanner_row {
  border-bottom-style: hidden;
}

#ifunqofwdx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ifunqofwdx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ifunqofwdx .gt_from_md > :first-child {
  margin-top: 0;
}

#ifunqofwdx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ifunqofwdx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ifunqofwdx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ifunqofwdx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ifunqofwdx .gt_row_group_first td {
  border-top-width: 2px;
}

#ifunqofwdx .gt_row_group_first th {
  border-top-width: 2px;
}

#ifunqofwdx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ifunqofwdx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ifunqofwdx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ifunqofwdx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ifunqofwdx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ifunqofwdx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ifunqofwdx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ifunqofwdx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ifunqofwdx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ifunqofwdx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ifunqofwdx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ifunqofwdx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ifunqofwdx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ifunqofwdx .gt_left {
  text-align: left;
}

#ifunqofwdx .gt_center {
  text-align: center;
}

#ifunqofwdx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ifunqofwdx .gt_font_normal {
  font-weight: normal;
}

#ifunqofwdx .gt_font_bold {
  font-weight: bold;
}

#ifunqofwdx .gt_font_italic {
  font-style: italic;
}

#ifunqofwdx .gt_super {
  font-size: 65%;
}

#ifunqofwdx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ifunqofwdx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ifunqofwdx .gt_indent_1 {
  text-indent: 5px;
}

#ifunqofwdx .gt_indent_2 {
  text-indent: 10px;
}

#ifunqofwdx .gt_indent_3 {
  text-indent: 15px;
}

#ifunqofwdx .gt_indent_4 {
  text-indent: 20px;
}

#ifunqofwdx .gt_indent_5 {
  text-indent: 25px;
}

#ifunqofwdx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ifunqofwdx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><em>Rent Burden — New York-Northern New Jersey-Long Island, NY-NJ-PA Metro Area</em></th>
</tr>
<tr class="gt_col_headings even">
<th id="year" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">year</th>
<th id="Rent" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Rent</th>
<th id="Income" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Income</th>
<th id="Rent-as-%-Income" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Rent as % Income</th>
<th id="RBI-(100-=-trimmed-base)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RBI (100 = trimmed base)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="year">2009</td>
<td class="gt_row gt_right" headers="Rent">$1,125</td>
<td class="gt_row gt_right" headers="Income">$62,887</td>
<td class="gt_row gt_right" headers="Rent as % Income">21.5%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">112.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2010</td>
<td class="gt_row gt_right" headers="Rent">$1,150</td>
<td class="gt_row gt_right" headers="Income">$61,927</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.3%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">116.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2011</td>
<td class="gt_row gt_right" headers="Rent">$1,187</td>
<td class="gt_row gt_right" headers="Income">$62,322</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.9%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">119.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2012</td>
<td class="gt_row gt_right" headers="Rent">$1,209</td>
<td class="gt_row gt_right" headers="Income">$63,982</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.7%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">118.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2013</td>
<td class="gt_row gt_right" headers="Rent">$1,237</td>
<td class="gt_row gt_right" headers="Income">$65,786</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.6%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">117.7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2014</td>
<td class="gt_row gt_right" headers="Rent">$1,281</td>
<td class="gt_row gt_right" headers="Income">$67,066</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.9%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">119.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2015</td>
<td class="gt_row gt_right" headers="Rent">$1,308</td>
<td class="gt_row gt_right" headers="Income">$68,743</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.8%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">119.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2016</td>
<td class="gt_row gt_right" headers="Rent">$1,346</td>
<td class="gt_row gt_right" headers="Income">$71,897</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.5%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">117.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2017</td>
<td class="gt_row gt_right" headers="Rent">$1,379</td>
<td class="gt_row gt_right" headers="Income">$75,368</td>
<td class="gt_row gt_right" headers="Rent as % Income">22%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">114.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2018</td>
<td class="gt_row gt_right" headers="Rent">$1,434</td>
<td class="gt_row gt_right" headers="Income">$78,478</td>
<td class="gt_row gt_right" headers="Rent as % Income">21.9%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">114.4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2019</td>
<td class="gt_row gt_right" headers="Rent">$1,482</td>
<td class="gt_row gt_right" headers="Income">$83,160</td>
<td class="gt_row gt_right" headers="Rent as % Income">21.4%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">111.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2021</td>
<td class="gt_row gt_right" headers="Rent">$1,600</td>
<td class="gt_row gt_right" headers="Income">$84,409</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.7%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">118.7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="year">2022</td>
<td class="gt_row gt_right" headers="Rent">$1,685</td>
<td class="gt_row gt_right" headers="Income">$91,562</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.1%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">115.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="year">2023</td>
<td class="gt_row gt_right" headers="Rent">$1,764</td>
<td class="gt_row gt_right" headers="Income">$95,220</td>
<td class="gt_row gt_right" headers="Rent as % Income">22.2%</td>
<td class="gt_row gt_right" headers="RBI (100 = trimmed base)">116.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="highlight-the-metro-areas-highest-and-lowest-with-the-highest-and-lowest-rent-burden" class="level4">
<h4 class="anchored" data-anchor-id="highlight-the-metro-areas-highest-and-lowest-with-the-highest-and-lowest-rent-burden">2-Highlight the Metro Areas highest and lowest with the highest and lowest rent burden</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Task 4.B: Highest / Lowest RBI (latest year) ----</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Self-contained safety helpers (harmless if already defined)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"fmt_comma"</span>)) fmt_comma <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"fmt_pc"</span>))    fmt_pc    <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">d =</span> <span class="dv">1</span>) <span class="fu">paste0</span>(<span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> x, d), <span class="st">"%"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%||%</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b) <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(a)) a <span class="cf">else</span> b</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Find the RBI column name present</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>rbi_col <span class="ot">&lt;-</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"RBI_100"</span> <span class="sc">%in%</span> <span class="fu">names</span>(rent_burden)) <span class="st">"RBI_100"</span> <span class="cf">else</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">"rbi_100"</span> <span class="sc">%in%</span> <span class="fu">names</span>(rent_burden)) <span class="st">"rbi_100"</span> <span class="cf">else</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Task 4.B: Could not find RBI column (expected 'RBI_100' or 'rbi_100'). Re-run Task 4 setup."</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Determine the latest year that actually has non-missing RBI values</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>latest_y <span class="ot">&lt;-</span> rent_burden <span class="sc">|&gt;</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(.data[[rbi_col]])) <span class="sc">|&gt;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">latest =</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(latest)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(latest_y)) <span class="fu">stop</span>(<span class="st">"Task 4.B: No non-missing RBI values found. Check Task 4 setup."</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Build the latest-year table with clean RBI values</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>rbi_latest <span class="ot">&lt;-</span> rent_burden <span class="sc">|&gt;</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> latest_y) <span class="sc">|&gt;</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, NAME, <span class="at">RBI =</span> dplyr<span class="sc">::</span><span class="fu">all_of</span>(rbi_col)) <span class="sc">|&gt;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(RBI)) <span class="sc">|&gt;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(GEOID, NAME, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)  <span class="co"># de-dup just in case</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Create Top/Bottom lists and render as gt tables</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>top_tbl <span class="ot">&lt;-</span> rbi_latest <span class="sc">|&gt;</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(RBI)) <span class="sc">|&gt;</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">RBI =</span> <span class="fu">round</span>(RBI, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME, <span class="st">`</span><span class="at">RBI (index)</span><span class="st">`</span> <span class="ot">=</span> RBI) <span class="sc">|&gt;</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> gt<span class="sc">::</span><span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"*Top 15 RBI — "</span>, latest_y, <span class="st">"*"</span>)),</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">subtitle =</span> <span class="st">"Higher values = higher rent burden (index)"</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>bot_tbl <span class="ot">&lt;-</span> rbi_latest <span class="sc">|&gt;</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(RBI) <span class="sc">|&gt;</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">RBI =</span> <span class="fu">round</span>(RBI, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME, <span class="st">`</span><span class="at">RBI (index)</span><span class="st">`</span> <span class="ot">=</span> RBI) <span class="sc">|&gt;</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> gt<span class="sc">::</span><span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"*Bottom 15 RBI — "</span>, latest_y, <span class="st">"*"</span>)),</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">subtitle =</span> <span class="st">"Lower values = lower rent burden (index)"</span>)</span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>top_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="knkmbxitti" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#knkmbxitti table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#knkmbxitti thead, #knkmbxitti tbody, #knkmbxitti tfoot, #knkmbxitti tr, #knkmbxitti td, #knkmbxitti th {
  border-style: none;
}

#knkmbxitti p {
  margin: 0;
  padding: 0;
}

#knkmbxitti .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#knkmbxitti .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#knkmbxitti .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#knkmbxitti .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#knkmbxitti .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#knkmbxitti .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#knkmbxitti .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#knkmbxitti .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#knkmbxitti .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#knkmbxitti .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#knkmbxitti .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#knkmbxitti .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#knkmbxitti .gt_spanner_row {
  border-bottom-style: hidden;
}

#knkmbxitti .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#knkmbxitti .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#knkmbxitti .gt_from_md > :first-child {
  margin-top: 0;
}

#knkmbxitti .gt_from_md > :last-child {
  margin-bottom: 0;
}

#knkmbxitti .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#knkmbxitti .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#knkmbxitti .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#knkmbxitti .gt_row_group_first td {
  border-top-width: 2px;
}

#knkmbxitti .gt_row_group_first th {
  border-top-width: 2px;
}

#knkmbxitti .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#knkmbxitti .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#knkmbxitti .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#knkmbxitti .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#knkmbxitti .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#knkmbxitti .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#knkmbxitti .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#knkmbxitti .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#knkmbxitti .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#knkmbxitti .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#knkmbxitti .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#knkmbxitti .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#knkmbxitti .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#knkmbxitti .gt_left {
  text-align: left;
}

#knkmbxitti .gt_center {
  text-align: center;
}

#knkmbxitti .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#knkmbxitti .gt_font_normal {
  font-weight: normal;
}

#knkmbxitti .gt_font_bold {
  font-weight: bold;
}

#knkmbxitti .gt_font_italic {
  font-style: italic;
}

#knkmbxitti .gt_super {
  font-size: 65%;
}

#knkmbxitti .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#knkmbxitti .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#knkmbxitti .gt_indent_1 {
  text-indent: 5px;
}

#knkmbxitti .gt_indent_2 {
  text-indent: 10px;
}

#knkmbxitti .gt_indent_3 {
  text-indent: 15px;
}

#knkmbxitti .gt_indent_4 {
  text-indent: 20px;
}

#knkmbxitti .gt_indent_5 {
  text-indent: 25px;
}

#knkmbxitti .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#knkmbxitti div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal"><em>Top 15 RBI — 2023</em></th>
</tr>
<tr class="gt_heading even">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Higher values = higher rent burden (index)</th>
</tr>
<tr class="gt_col_headings header">
<th id="CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA</th>
<th id="RBI-(index)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RBI (index)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Clearlake, CA Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">162.7</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Aguadilla, PR Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">161.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Cape Coral-Fort Myers, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">157.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Miami-Fort Lauderdale-West Palm Beach, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">157.1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Port St. Lucie, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">153.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Ponce, PR Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">149.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Tampa-St. Petersburg-Clearwater, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">148.8</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Key West-Key Largo, FL Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">147.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">North Port-Bradenton-Sarasota, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">147.1</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Ocala, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">145.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Orlando-Kissimmee-Sanford, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">145.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Salinas, CA Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">142.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Chico, CA Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">142.0</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Naples-Marco Island, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">141.8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Deltona-Daytona Beach-Ormond Beach, FL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">141.3</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bot_tbl</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="qzlgigwhiy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qzlgigwhiy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qzlgigwhiy thead, #qzlgigwhiy tbody, #qzlgigwhiy tfoot, #qzlgigwhiy tr, #qzlgigwhiy td, #qzlgigwhiy th {
  border-style: none;
}

#qzlgigwhiy p {
  margin: 0;
  padding: 0;
}

#qzlgigwhiy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qzlgigwhiy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qzlgigwhiy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qzlgigwhiy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qzlgigwhiy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qzlgigwhiy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qzlgigwhiy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qzlgigwhiy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qzlgigwhiy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qzlgigwhiy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qzlgigwhiy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qzlgigwhiy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qzlgigwhiy .gt_spanner_row {
  border-bottom-style: hidden;
}

#qzlgigwhiy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qzlgigwhiy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qzlgigwhiy .gt_from_md > :first-child {
  margin-top: 0;
}

#qzlgigwhiy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qzlgigwhiy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qzlgigwhiy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qzlgigwhiy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qzlgigwhiy .gt_row_group_first td {
  border-top-width: 2px;
}

#qzlgigwhiy .gt_row_group_first th {
  border-top-width: 2px;
}

#qzlgigwhiy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qzlgigwhiy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qzlgigwhiy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qzlgigwhiy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qzlgigwhiy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qzlgigwhiy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qzlgigwhiy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qzlgigwhiy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qzlgigwhiy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qzlgigwhiy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qzlgigwhiy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qzlgigwhiy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qzlgigwhiy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qzlgigwhiy .gt_left {
  text-align: left;
}

#qzlgigwhiy .gt_center {
  text-align: center;
}

#qzlgigwhiy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qzlgigwhiy .gt_font_normal {
  font-weight: normal;
}

#qzlgigwhiy .gt_font_bold {
  font-weight: bold;
}

#qzlgigwhiy .gt_font_italic {
  font-style: italic;
}

#qzlgigwhiy .gt_super {
  font-size: 65%;
}

#qzlgigwhiy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qzlgigwhiy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qzlgigwhiy .gt_indent_1 {
  text-indent: 5px;
}

#qzlgigwhiy .gt_indent_2 {
  text-indent: 10px;
}

#qzlgigwhiy .gt_indent_3 {
  text-indent: 15px;
}

#qzlgigwhiy .gt_indent_4 {
  text-indent: 20px;
}

#qzlgigwhiy .gt_indent_5 {
  text-indent: 25px;
}

#qzlgigwhiy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qzlgigwhiy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal"><em>Bottom 15 RBI — 2023</em></th>
</tr>
<tr class="gt_heading even">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Lower values = lower rent burden (index)</th>
</tr>
<tr class="gt_col_headings header">
<th id="CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA</th>
<th id="RBI-(index)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">RBI (index)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Laconia, NH Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">66.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Manitowoc, WI Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">69.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Bismarck, ND Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">71.4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Watertown-Fort Atkinson, WI Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">72.0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Wisconsin Rapids-Marshfield, WI Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">72.2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Jefferson City, MO Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">72.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Decatur, AL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">73.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Talladega-Sylacauga, AL Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">74.1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Mount Airy, NC Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">74.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Albertville, AL Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">75.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Dubuque, IA Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">75.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Seneca, SC Micro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">75.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Paducah, KY-IL Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">76.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Midland, MI Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">76.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Sheboygan, WI Metro Area</td>
<td class="gt_row gt_right" headers="RBI (index)">76.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="task-5-housing-growth" class="level3">
<h3 class="anchored" data-anchor-id="task-5-housing-growth">Task 5: Housing Growth</h3>
<p>Method:</p>
<p>-Instantaneous: permits per 1,000 residents</p>
<p>-Rate-based: permits ÷ 5-year population growth (winsorized at 99th pct)</p>
<p>-Scaled within year to [0,1]; Composite = 0.4<em>Instant + 0.6</em>Rate</p>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.finite</span>(rng)) <span class="sc">||</span> <span class="fu">diff</span>(rng) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(x)))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> <span class="fu">diff</span>(rng)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> POPULATION <span class="sc">|&gt;</span> <span class="fu">select</span>(GEOID, year, <span class="at">pop =</span> population)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> PERMITS    <span class="sc">|&gt;</span> <span class="fu">select</span>(CBSA, year, <span class="at">permits =</span> new_housing_units_permitted) <span class="sc">|&gt;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GEOID =</span> CBSA)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pop <span class="sc">|&gt;</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(perm, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_catalog <span class="sc">|&gt;</span> <span class="fu">select</span>(GEOID, NAME), <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(GEOID, year) <span class="sc">|&gt;</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID) <span class="sc">|&gt;</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_lag5 =</span> <span class="fu">lag</span>(pop, <span class="dv">5</span>),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop_g5   =</span> pop <span class="sc">-</span> pop_lag5) <span class="sc">|&gt;</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>inst <span class="ot">&lt;-</span> pp <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">inst_per_1k =</span> <span class="dv">1000</span> <span class="sc">*</span> permits <span class="sc">/</span> pop)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> inst <span class="sc">|&gt;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate_vs_g5 =</span> <span class="fu">if_else</span>(pop_g5 <span class="sc">&gt;</span> <span class="dv">0</span>, permits <span class="sc">/</span> pop_g5, <span class="cn">NA_real_</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rate_vs_g5 =</span> <span class="fu">pmin</span>(rate_vs_g5, <span class="fu">quantile</span>(rate_vs_g5, <span class="fl">0.99</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>hg_scaled <span class="ot">&lt;-</span> rate <span class="sc">|&gt;</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inst_s =</span> <span class="fu">scale01</span>(inst_per_1k),</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">rate_s =</span> <span class="fu">scale01</span>(rate_vs_g5)) <span class="sc">|&gt;</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hg_comp =</span> <span class="fl">0.4</span> <span class="sc">*</span> inst_s <span class="sc">+</span> <span class="fl">0.6</span> <span class="sc">*</span> rate_s)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>late_period <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">2021</span>, <span class="dv">2022</span>, <span class="dv">2023</span>)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>hg_rank <span class="ot">&lt;-</span> hg_scaled <span class="sc">|&gt;</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> late_period) <span class="sc">|&gt;</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, NAME) <span class="sc">|&gt;</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">inst_mean =</span> <span class="fu">mean</span>(inst_s, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">rate_mean =</span> <span class="fu">mean</span>(rate_s, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">comp_mean =</span> <span class="fu">mean</span>(hg_comp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="construct-your-metric-in-two-parts" class="level3">
<h3 class="anchored" data-anchor-id="construct-your-metric-in-two-parts">Construct your metric in two parts:</h3>
<section id="an-instantaneous-measure-of-housing-growth-that-depends-on-the-absolute-population-of-a-cbsa-and-the-number-of-new-housing-units-permitted-that-year." class="level4">
<h4 class="anchored" data-anchor-id="an-instantaneous-measure-of-housing-growth-that-depends-on-the-absolute-population-of-a-cbsa-and-the-number-of-new-housing-units-permitted-that-year.">1-An ‘instantaneous’ measure of housing growth that depends on the absolute population of a CBSA and the number of new housing units permitted that year.</h4>
</section>
<section id="a-rate-based-measure-of-housing-growth-that-compares-the-number-of-housing-permits-to-the-population-growth-over-a-5-year-lookback-window." class="level4">
<h4 class="anchored" data-anchor-id="a-rate-based-measure-of-housing-growth-that-compares-the-number-of-housing-permits-to-the-population-growth-over-a-5-year-lookback-window.">2-A ‘rate-based’ measure of housing growth that compares the number of housing permits to the population growth over a 5 year lookback window.</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 5.A — Instantaneous &amp; Rate-based housing growth (tables, latest year)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal helpers</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fmt_comma <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">","</span>, <span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>fmt_num   <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">d=</span><span class="dv">2</span>) <span class="fu">format</span>(<span class="fu">round</span>(x, d), <span class="at">nsmall=</span>d, <span class="at">trim=</span><span class="cn">TRUE</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare panel</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>pop  <span class="ot">&lt;-</span> POPULATION <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, year, <span class="at">pop =</span> population)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> PERMITS    <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(CBSA, year, <span class="at">permits =</span> new_housing_units_permitted) <span class="sc">|&gt;</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">GEOID =</span> CBSA)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pop <span class="sc">|&gt;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(perm, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(cbsa_catalog <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(GEOID, NAME), <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(GEOID, year) <span class="sc">|&gt;</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(GEOID) <span class="sc">|&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pop_lag5 =</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(pop, <span class="dv">5</span>),</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">pop_g5   =</span> pop <span class="sc">-</span> pop_lag5) <span class="sc">|&gt;</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">inst_per_1k =</span> <span class="dv">1000</span> <span class="sc">*</span> permits <span class="sc">/</span> pop,</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">rate_vs_g5_raw =</span> dplyr<span class="sc">::</span><span class="fu">if_else</span>(pop_g5 <span class="sc">&gt;</span> <span class="dv">0</span>, permits <span class="sc">/</span> pop_g5, <span class="cn">NA_real_</span>)) <span class="sc">|&gt;</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(year) <span class="sc">|&gt;</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rate_vs_g5 =</span> <span class="fu">pmin</span>(rate_vs_g5_raw, stats<span class="sc">::</span><span class="fu">quantile</span>(rate_vs_g5_raw, <span class="fl">0.99</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="sc">|&gt;</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Latest year with non-missing metrics</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>metric_year <span class="ot">&lt;-</span> pp <span class="sc">|&gt;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(inst_per_1k) <span class="sc">|</span> <span class="sc">!</span><span class="fu">is.na</span>(rate_vs_g5)) <span class="sc">|&gt;</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">latest =</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(latest)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantaneous tables (permits per 1k pop)</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>inst_yr <span class="ot">&lt;-</span> pp <span class="sc">|&gt;</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> metric_year, <span class="fu">is.finite</span>(inst_per_1k)) <span class="sc">|&gt;</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(NAME, permits, pop, inst_per_1k)</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(inst_yr <span class="sc">|&gt;</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(inst_per_1k)) <span class="sc">|&gt;</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="st">`</span><span class="at">CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME,</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(permits),</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(pop),</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits per 1K</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_num</span>(inst_per_1k))) <span class="sc">|&gt;</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> gt<span class="sc">::</span><span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"**Instantaneous Growth — Top 15 ("</span>, metric_year, <span class="st">")**"</span>)),</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">subtitle =</span> <span class="st">"Permits per 1,000 residents"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="toenqzovdj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#toenqzovdj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#toenqzovdj thead, #toenqzovdj tbody, #toenqzovdj tfoot, #toenqzovdj tr, #toenqzovdj td, #toenqzovdj th {
  border-style: none;
}

#toenqzovdj p {
  margin: 0;
  padding: 0;
}

#toenqzovdj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#toenqzovdj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#toenqzovdj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#toenqzovdj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#toenqzovdj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#toenqzovdj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#toenqzovdj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#toenqzovdj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#toenqzovdj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#toenqzovdj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#toenqzovdj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#toenqzovdj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#toenqzovdj .gt_spanner_row {
  border-bottom-style: hidden;
}

#toenqzovdj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#toenqzovdj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#toenqzovdj .gt_from_md > :first-child {
  margin-top: 0;
}

#toenqzovdj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#toenqzovdj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#toenqzovdj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#toenqzovdj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#toenqzovdj .gt_row_group_first td {
  border-top-width: 2px;
}

#toenqzovdj .gt_row_group_first th {
  border-top-width: 2px;
}

#toenqzovdj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#toenqzovdj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#toenqzovdj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#toenqzovdj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#toenqzovdj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#toenqzovdj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#toenqzovdj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#toenqzovdj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#toenqzovdj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#toenqzovdj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#toenqzovdj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#toenqzovdj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#toenqzovdj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#toenqzovdj .gt_left {
  text-align: left;
}

#toenqzovdj .gt_center {
  text-align: center;
}

#toenqzovdj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#toenqzovdj .gt_font_normal {
  font-weight: normal;
}

#toenqzovdj .gt_font_bold {
  font-weight: bold;
}

#toenqzovdj .gt_font_italic {
  font-style: italic;
}

#toenqzovdj .gt_super {
  font-size: 65%;
}

#toenqzovdj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#toenqzovdj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#toenqzovdj .gt_indent_1 {
  text-indent: 5px;
}

#toenqzovdj .gt_indent_2 {
  text-indent: 10px;
}

#toenqzovdj .gt_indent_3 {
  text-indent: 15px;
}

#toenqzovdj .gt_indent_4 {
  text-indent: 20px;
}

#toenqzovdj .gt_indent_5 {
  text-indent: 25px;
}

#toenqzovdj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#toenqzovdj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><strong>Instantaneous Growth — Top 15 (2023)</strong></th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Permits per 1,000 residents</th>
</tr>
<tr class="gt_col_headings header">
<th id="CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA</th>
<th id="Permits" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits</th>
<th id="Population" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Population</th>
<th id="Permits-per-1K" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits per 1K</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Salisbury, MD Metro Area</td>
<td class="gt_row gt_right" headers="Permits">4,894</td>
<td class="gt_row gt_right" headers="Population">129,710</td>
<td class="gt_row gt_right" headers="Permits per 1K">37.73</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Salisbury, MD-DE Metro Area</td>
<td class="gt_row gt_right" headers="Permits">4,894</td>
<td class="gt_row gt_right" headers="Population">129,710</td>
<td class="gt_row gt_right" headers="Permits per 1K">37.73</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Myrtle Beach-North Myrtle Beach-Conway, SC Metro Area</td>
<td class="gt_row gt_right" headers="Permits">13,176</td>
<td class="gt_row gt_right" headers="Population">397,478</td>
<td class="gt_row gt_right" headers="Permits per 1K">33.15</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area</td>
<td class="gt_row gt_right" headers="Permits">13,176</td>
<td class="gt_row gt_right" headers="Population">397,478</td>
<td class="gt_row gt_right" headers="Permits per 1K">33.15</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Myrtle Beach-Conway-North Myrtle Beach, SC Metro Area</td>
<td class="gt_row gt_right" headers="Permits">13,176</td>
<td class="gt_row gt_right" headers="Population">397,478</td>
<td class="gt_row gt_right" headers="Permits per 1K">33.15</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Punta Gorda, FL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">4,429</td>
<td class="gt_row gt_right" headers="Population">206,134</td>
<td class="gt_row gt_right" headers="Permits per 1K">21.49</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Crestview-Fort Walton Beach-Destin, FL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">5,596</td>
<td class="gt_row gt_right" headers="Population">304,818</td>
<td class="gt_row gt_right" headers="Permits per 1K">18.36</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">North Port-Bradenton-Sarasota, FL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">15,928</td>
<td class="gt_row gt_right" headers="Population">910,108</td>
<td class="gt_row gt_right" headers="Permits per 1K">17.50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">North Port-Sarasota-Bradenton, FL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">15,928</td>
<td class="gt_row gt_right" headers="Population">910,108</td>
<td class="gt_row gt_right" headers="Permits per 1K">17.50</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Daphne-Fairhope-Foley, AL Micro Area</td>
<td class="gt_row gt_right" headers="Permits">4,363</td>
<td class="gt_row gt_right" headers="Population">253,507</td>
<td class="gt_row gt_right" headers="Permits per 1K">17.21</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Daphne-Fairhope-Foley, AL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">4,363</td>
<td class="gt_row gt_right" headers="Population">253,507</td>
<td class="gt_row gt_right" headers="Permits per 1K">17.21</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Sherman-Denison, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits">2,447</td>
<td class="gt_row gt_right" headers="Population">146,907</td>
<td class="gt_row gt_right" headers="Permits per 1K">16.66</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Cape Coral-Fort Myers, FL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">13,556</td>
<td class="gt_row gt_right" headers="Population">834,573</td>
<td class="gt_row gt_right" headers="Permits per 1K">16.24</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Austin-Round Rock, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits">38,773</td>
<td class="gt_row gt_right" headers="Population">2,473,275</td>
<td class="gt_row gt_right" headers="Permits per 1K">15.68</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Austin-Round Rock-San Marcos, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits">38,773</td>
<td class="gt_row gt_right" headers="Population">2,473,275</td>
<td class="gt_row gt_right" headers="Permits per 1K">15.68</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(inst_yr <span class="sc">|&gt;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">arrange</span>(inst_per_1k) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="st">`</span><span class="at">CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(permits),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(pop),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits per 1K</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_num</span>(inst_per_1k))) <span class="sc">|&gt;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> gt<span class="sc">::</span><span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"**Instantaneous Growth — Bottom 15 ("</span>, metric_year, <span class="st">")**"</span>)),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">subtitle =</span> <span class="st">"Permits per 1,000 residents"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="bmecgoxjxf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bmecgoxjxf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bmecgoxjxf thead, #bmecgoxjxf tbody, #bmecgoxjxf tfoot, #bmecgoxjxf tr, #bmecgoxjxf td, #bmecgoxjxf th {
  border-style: none;
}

#bmecgoxjxf p {
  margin: 0;
  padding: 0;
}

#bmecgoxjxf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bmecgoxjxf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bmecgoxjxf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bmecgoxjxf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bmecgoxjxf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bmecgoxjxf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bmecgoxjxf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bmecgoxjxf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bmecgoxjxf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bmecgoxjxf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bmecgoxjxf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bmecgoxjxf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bmecgoxjxf .gt_spanner_row {
  border-bottom-style: hidden;
}

#bmecgoxjxf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bmecgoxjxf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bmecgoxjxf .gt_from_md > :first-child {
  margin-top: 0;
}

#bmecgoxjxf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bmecgoxjxf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bmecgoxjxf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bmecgoxjxf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bmecgoxjxf .gt_row_group_first td {
  border-top-width: 2px;
}

#bmecgoxjxf .gt_row_group_first th {
  border-top-width: 2px;
}

#bmecgoxjxf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmecgoxjxf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bmecgoxjxf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bmecgoxjxf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bmecgoxjxf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmecgoxjxf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bmecgoxjxf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bmecgoxjxf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bmecgoxjxf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bmecgoxjxf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bmecgoxjxf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmecgoxjxf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bmecgoxjxf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmecgoxjxf .gt_left {
  text-align: left;
}

#bmecgoxjxf .gt_center {
  text-align: center;
}

#bmecgoxjxf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bmecgoxjxf .gt_font_normal {
  font-weight: normal;
}

#bmecgoxjxf .gt_font_bold {
  font-weight: bold;
}

#bmecgoxjxf .gt_font_italic {
  font-style: italic;
}

#bmecgoxjxf .gt_super {
  font-size: 65%;
}

#bmecgoxjxf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bmecgoxjxf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bmecgoxjxf .gt_indent_1 {
  text-indent: 5px;
}

#bmecgoxjxf .gt_indent_2 {
  text-indent: 10px;
}

#bmecgoxjxf .gt_indent_3 {
  text-indent: 15px;
}

#bmecgoxjxf .gt_indent_4 {
  text-indent: 20px;
}

#bmecgoxjxf .gt_indent_5 {
  text-indent: 25px;
}

#bmecgoxjxf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bmecgoxjxf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><strong>Instantaneous Growth — Bottom 15 (2023)</strong></th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Permits per 1,000 residents</th>
</tr>
<tr class="gt_col_headings header">
<th id="CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA</th>
<th id="Permits" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits</th>
<th id="Population" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Population</th>
<th id="Permits-per-1K" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits per 1K</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Wheeling, WV-OH Metro Area</td>
<td class="gt_row gt_right" headers="Permits">11</td>
<td class="gt_row gt_right" headers="Population">135,517</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.08</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Danville, IL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">8</td>
<td class="gt_row gt_right" headers="Population">71,652</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.11</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Danville, IL Micro Area</td>
<td class="gt_row gt_right" headers="Permits">8</td>
<td class="gt_row gt_right" headers="Population">71,652</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.11</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Morgantown, WV Metro Area</td>
<td class="gt_row gt_right" headers="Permits">17</td>
<td class="gt_row gt_right" headers="Population">141,817</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.12</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Weirton-Steubenville, WV-OH Metro Area</td>
<td class="gt_row gt_right" headers="Permits">16</td>
<td class="gt_row gt_right" headers="Population">114,106</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.14</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Enid, OK Metro Area</td>
<td class="gt_row gt_right" headers="Permits">10</td>
<td class="gt_row gt_right" headers="Population">62,023</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Decatur, IL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">34</td>
<td class="gt_row gt_right" headers="Population">100,591</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.34</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Johnstown, PA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">47</td>
<td class="gt_row gt_right" headers="Population">130,668</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.36</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Bay City, MI Metro Area</td>
<td class="gt_row gt_right" headers="Permits">38</td>
<td class="gt_row gt_right" headers="Population">102,500</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.37</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Williamsport, PA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">57</td>
<td class="gt_row gt_right" headers="Population">112,724</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.51</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Fairbanks, AK Metro Area</td>
<td class="gt_row gt_right" headers="Permits">49</td>
<td class="gt_row gt_right" headers="Population">94,840</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.52</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Fairbanks-College, AK Metro Area</td>
<td class="gt_row gt_right" headers="Permits">49</td>
<td class="gt_row gt_right" headers="Population">94,840</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.52</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Anniston-Oxford, AL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">64</td>
<td class="gt_row gt_right" headers="Population">116,429</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.55</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Anniston-Oxford-Jacksonville, AL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">64</td>
<td class="gt_row gt_right" headers="Population">116,429</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.55</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Peoria, IL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">210</td>
<td class="gt_row gt_right" headers="Population">361,989</td>
<td class="gt_row gt_right" headers="Permits per 1K">0.58</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rate-based tables (permits per 5y pop growth, winsorized)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>rate_yr <span class="ot">&lt;-</span> pp <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">==</span> metric_year, <span class="fu">is.finite</span>(rate_vs_g5)) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(NAME, permits, pop_g5, rate_vs_g5)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(rate_yr <span class="sc">|&gt;</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(rate_vs_g5)) <span class="sc">|&gt;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="st">`</span><span class="at">CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(permits),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">5y Pop Growth</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(pop_g5),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits per 5y Growth</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_num</span>(rate_vs_g5))) <span class="sc">|&gt;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> gt<span class="sc">::</span><span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"**Rate-based Growth — Top 15 ("</span>, metric_year, <span class="st">")**"</span>)),</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">subtitle =</span> <span class="st">"Permits per 5-year population growth (winsorized)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fbodvryvlm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fbodvryvlm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fbodvryvlm thead, #fbodvryvlm tbody, #fbodvryvlm tfoot, #fbodvryvlm tr, #fbodvryvlm td, #fbodvryvlm th {
  border-style: none;
}

#fbodvryvlm p {
  margin: 0;
  padding: 0;
}

#fbodvryvlm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fbodvryvlm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fbodvryvlm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fbodvryvlm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fbodvryvlm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fbodvryvlm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbodvryvlm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fbodvryvlm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fbodvryvlm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fbodvryvlm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fbodvryvlm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fbodvryvlm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fbodvryvlm .gt_spanner_row {
  border-bottom-style: hidden;
}

#fbodvryvlm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fbodvryvlm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fbodvryvlm .gt_from_md > :first-child {
  margin-top: 0;
}

#fbodvryvlm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fbodvryvlm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fbodvryvlm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fbodvryvlm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fbodvryvlm .gt_row_group_first td {
  border-top-width: 2px;
}

#fbodvryvlm .gt_row_group_first th {
  border-top-width: 2px;
}

#fbodvryvlm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbodvryvlm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fbodvryvlm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fbodvryvlm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbodvryvlm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbodvryvlm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fbodvryvlm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fbodvryvlm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fbodvryvlm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbodvryvlm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fbodvryvlm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbodvryvlm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fbodvryvlm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbodvryvlm .gt_left {
  text-align: left;
}

#fbodvryvlm .gt_center {
  text-align: center;
}

#fbodvryvlm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fbodvryvlm .gt_font_normal {
  font-weight: normal;
}

#fbodvryvlm .gt_font_bold {
  font-weight: bold;
}

#fbodvryvlm .gt_font_italic {
  font-style: italic;
}

#fbodvryvlm .gt_super {
  font-size: 65%;
}

#fbodvryvlm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fbodvryvlm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fbodvryvlm .gt_indent_1 {
  text-indent: 5px;
}

#fbodvryvlm .gt_indent_2 {
  text-indent: 10px;
}

#fbodvryvlm .gt_indent_3 {
  text-indent: 15px;
}

#fbodvryvlm .gt_indent_4 {
  text-indent: 20px;
}

#fbodvryvlm .gt_indent_5 {
  text-indent: 25px;
}

#fbodvryvlm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fbodvryvlm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><strong>Rate-based Growth — Top 15 (2023)</strong></th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Permits per 5-year population growth (winsorized)</th>
</tr>
<tr class="gt_col_headings header">
<th id="CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA</th>
<th id="Permits" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits</th>
<th id="a5y-Pop-Growth" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">5y Pop Growth</th>
<th id="Permits-per-5y-Growth" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits per 5y Growth</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Brunswick-St. Simons, GA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">786</td>
<td class="gt_row gt_right" headers="5y Pop Growth">54</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">3.48</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Muskegon, MI Metro Area</td>
<td class="gt_row gt_right" headers="Permits">312</td>
<td class="gt_row gt_right" headers="5y Pop Growth">53</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">3.48</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Olympia-Lacey-Tumwater, WA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">1,512</td>
<td class="gt_row gt_right" headers="5y Pop Growth">245</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">3.48</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Springfield, OH Metro Area</td>
<td class="gt_row gt_right" headers="Permits">215</td>
<td class="gt_row gt_right" headers="5y Pop Growth">53</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">3.48</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Sacramento-Roseville-Folsom, CA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">11,941</td>
<td class="gt_row gt_right" headers="5y Pop Growth">3,906</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">3.06</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Urban Honolulu, HI Metro Area</td>
<td class="gt_row gt_right" headers="Permits">1,851</td>
<td class="gt_row gt_right" headers="5y Pop Growth">758</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">2.44</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Macon-Bibb County, GA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">567</td>
<td class="gt_row gt_right" headers="5y Pop Growth">245</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">2.31</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Dayton-Kettering-Beavercreek, OH Metro Area</td>
<td class="gt_row gt_right" headers="Permits">1,766</td>
<td class="gt_row gt_right" headers="5y Pop Growth">847</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">2.09</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Salt Lake City-Murray, UT Metro Area</td>
<td class="gt_row gt_right" headers="Permits">9,235</td>
<td class="gt_row gt_right" headers="5y Pop Growth">4,803</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.92</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Dalton, GA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">496</td>
<td class="gt_row gt_right" headers="5y Pop Growth">282</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.76</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Racine, WI Metro Area</td>
<td class="gt_row gt_right" headers="Permits">524</td>
<td class="gt_row gt_right" headers="5y Pop Growth">302</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.74</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Olympia, WA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">1,512</td>
<td class="gt_row gt_right" headers="5y Pop Growth">1,026</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.47</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Olympia-Tumwater, WA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">1,512</td>
<td class="gt_row gt_right" headers="5y Pop Growth">1,026</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.47</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Grand Island, NE Metro Area</td>
<td class="gt_row gt_right" headers="Permits">399</td>
<td class="gt_row gt_right" headers="5y Pop Growth">304</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.31</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Sacramento--Arden-Arcade--Roseville, CA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">11,941</td>
<td class="gt_row gt_right" headers="5y Pop Growth">9,180</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">1.30</td>
</tr>
</tbody>
</table>

</div>
</div>
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gt</span>(rate_yr <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">arrange</span>(rate_vs_g5) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">transmute</span>(<span class="st">`</span><span class="at">CBSA</span><span class="st">`</span> <span class="ot">=</span> NAME,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(permits),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">5y Pop Growth</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_comma</span>(pop_g5),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">Permits per 5y Growth</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">fmt_num</span>(rate_vs_g5))) <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> gt<span class="sc">::</span><span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"**Rate-based Growth — Bottom 15 ("</span>, metric_year, <span class="st">")**"</span>)),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">subtitle =</span> <span class="st">"Permits per 5-year population growth (winsorized)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="yebzzqslgh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yebzzqslgh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yebzzqslgh thead, #yebzzqslgh tbody, #yebzzqslgh tfoot, #yebzzqslgh tr, #yebzzqslgh td, #yebzzqslgh th {
  border-style: none;
}

#yebzzqslgh p {
  margin: 0;
  padding: 0;
}

#yebzzqslgh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yebzzqslgh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yebzzqslgh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yebzzqslgh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yebzzqslgh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yebzzqslgh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yebzzqslgh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yebzzqslgh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yebzzqslgh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yebzzqslgh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yebzzqslgh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yebzzqslgh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yebzzqslgh .gt_spanner_row {
  border-bottom-style: hidden;
}

#yebzzqslgh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yebzzqslgh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yebzzqslgh .gt_from_md > :first-child {
  margin-top: 0;
}

#yebzzqslgh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yebzzqslgh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yebzzqslgh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yebzzqslgh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yebzzqslgh .gt_row_group_first td {
  border-top-width: 2px;
}

#yebzzqslgh .gt_row_group_first th {
  border-top-width: 2px;
}

#yebzzqslgh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yebzzqslgh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yebzzqslgh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yebzzqslgh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yebzzqslgh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yebzzqslgh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yebzzqslgh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yebzzqslgh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yebzzqslgh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yebzzqslgh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yebzzqslgh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yebzzqslgh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yebzzqslgh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yebzzqslgh .gt_left {
  text-align: left;
}

#yebzzqslgh .gt_center {
  text-align: center;
}

#yebzzqslgh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yebzzqslgh .gt_font_normal {
  font-weight: normal;
}

#yebzzqslgh .gt_font_bold {
  font-weight: bold;
}

#yebzzqslgh .gt_font_italic {
  font-style: italic;
}

#yebzzqslgh .gt_super {
  font-size: 65%;
}

#yebzzqslgh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yebzzqslgh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yebzzqslgh .gt_indent_1 {
  text-indent: 5px;
}

#yebzzqslgh .gt_indent_2 {
  text-indent: 10px;
}

#yebzzqslgh .gt_indent_3 {
  text-indent: 15px;
}

#yebzzqslgh .gt_indent_4 {
  text-indent: 20px;
}

#yebzzqslgh .gt_indent_5 {
  text-indent: 25px;
}

#yebzzqslgh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yebzzqslgh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal"><strong>Rate-based Growth — Bottom 15 (2023)</strong></th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Permits per 5-year population growth (winsorized)</th>
</tr>
<tr class="gt_col_headings header">
<th id="CBSA" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">CBSA</th>
<th id="Permits" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits</th>
<th id="a5y-Pop-Growth" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">5y Pop Growth</th>
<th id="Permits-per-5y-Growth" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Permits per 5y Growth</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Atlantic City-Hammonton, NJ Metro Area</td>
<td class="gt_row gt_right" headers="Permits">383</td>
<td class="gt_row gt_right" headers="5y Pop Growth">99,905</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Longview, TX Metro Area</td>
<td class="gt_row gt_right" headers="Permits">364</td>
<td class="gt_row gt_right" headers="5y Pop Growth">76,017</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Morgantown, WV Metro Area</td>
<td class="gt_row gt_right" headers="Permits">17</td>
<td class="gt_row gt_right" headers="5y Pop Growth">3,108</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.01</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Manhattan, KS Metro Area</td>
<td class="gt_row gt_right" headers="Permits">257</td>
<td class="gt_row gt_right" headers="5y Pop Growth">34,751</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.01</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Jackson, TN Metro Area</td>
<td class="gt_row gt_right" headers="Permits">434</td>
<td class="gt_row gt_right" headers="5y Pop Growth">52,591</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.01</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Ames, IA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">262</td>
<td class="gt_row gt_right" headers="5y Pop Growth">27,654</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.01</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Monroe, LA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">417</td>
<td class="gt_row gt_right" headers="5y Pop Growth">43,896</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.01</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">La Crosse, WI-MN Metro Area</td>
<td class="gt_row gt_right" headers="Permits">472</td>
<td class="gt_row gt_right" headers="5y Pop Growth">33,622</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.01</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">La Crosse-Onalaska, WI-MN Metro Area</td>
<td class="gt_row gt_right" headers="Permits">472</td>
<td class="gt_row gt_right" headers="5y Pop Growth">31,027</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Fresno, CA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">3,154</td>
<td class="gt_row gt_right" headers="5y Pop Growth">190,765</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Cape Girardeau-Jackson, MO-IL Metro Area</td>
<td class="gt_row gt_right" headers="Permits">79</td>
<td class="gt_row gt_right" headers="5y Pop Growth">4,550</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Billings, MT Metro Area</td>
<td class="gt_row gt_right" headers="Permits">349</td>
<td class="gt_row gt_right" headers="5y Pop Growth">19,354</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Columbia, MO Metro Area</td>
<td class="gt_row gt_right" headers="Permits">681</td>
<td class="gt_row gt_right" headers="5y Pop Growth">37,540</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="CBSA">Hattiesburg, MS Metro Area</td>
<td class="gt_row gt_right" headers="Permits">169</td>
<td class="gt_row gt_right" headers="5y Pop Growth">9,305</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="CBSA">Merced, CA Metro Area</td>
<td class="gt_row gt_right" headers="Permits">406</td>
<td class="gt_row gt_right" headers="5y Pop Growth">19,247</td>
<td class="gt_row gt_right" headers="Permits per 5y Growth">0.02</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="task-6-visualization" class="level3">
<h3 class="anchored" data-anchor-id="task-6-visualization">Task 6: Visualization</h3>
<p>Create (at least) two visualizations to investigate the relationships between your Rent Burden and Housing Growth metrics.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Task 6 Setup —</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gghighlight)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ r <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>); <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.finite</span>(r)) <span class="sc">||</span> <span class="fu">diff</span>(r)<span class="sc">==</span><span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(x))); (x<span class="sc">-</span>r[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">diff</span>(r) }</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a CBSA name catalog from whatever table has names (INCOME or POPULATION)</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">"NAME"</span> <span class="sc">%in%</span> <span class="fu">names</span>(INCOME)) {</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  cbsa_catalog <span class="ot">&lt;-</span> INCOME <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(GEOID, NAME)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="st">"NAME"</span> <span class="sc">%in%</span> <span class="fu">names</span>(POPULATION)) {</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  cbsa_catalog <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(GEOID, NAME)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Could not find CBSA name column `NAME` in INCOME or POPULATION."</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Rent Burden time series (RBI) ----</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Use correct column names: RENT$monthly_rent and INCOME$household_income</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>rb_df <span class="ot">&lt;-</span> RENT <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, year, <span class="at">rent =</span> monthly_rent) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(INCOME <span class="sc">%&gt;%</span> <span class="fu">select</span>(GEOID, year, <span class="at">income =</span> household_income), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_catalog, <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rb_share =</span> (<span class="dv">12</span> <span class="sc">*</span> rent) <span class="sc">/</span> income)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Baseline = national average in first available year</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>base_year <span class="ot">&lt;-</span> <span class="fu">min</span>(rb_df<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>base_mu   <span class="ot">&lt;-</span> rb_df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> base_year) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">mu =</span> <span class="fu">mean</span>(rb_share, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(mu)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>rb_df <span class="ot">&lt;-</span> rb_df <span class="sc">%&gt;%</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RBI =</span> <span class="dv">100</span> <span class="sc">*</span> rb_share <span class="sc">/</span> base_mu) <span class="sc">%&gt;%</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, NAME, year, RBI)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Housing Growth components &amp; composite (HGI) ----</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>pop  <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span> <span class="fu">select</span>(GEOID, year, <span class="at">pop =</span> population)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> PERMITS    <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">GEOID =</span> CBSA, year, <span class="at">permits =</span> new_housing_units_permitted)</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> pop <span class="sc">%&gt;%</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(perm, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_catalog, <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(GEOID, year) <span class="sc">%&gt;%</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_lag5 =</span> <span class="fu">lag</span>(pop, <span class="dv">5</span>),</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop_g5   =</span> pop <span class="sc">-</span> pop_lag5) <span class="sc">%&gt;%</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_per_1k   =</span> <span class="dv">1000</span> <span class="sc">*</span> permits <span class="sc">/</span> pop,</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_vs_g5raw =</span> <span class="fu">if_else</span>(pop_g5 <span class="sc">&gt;</span> <span class="dv">0</span>, permits <span class="sc">/</span> pop_g5, <span class="cn">NA_real_</span>)</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># winsorize rate metric at 99th pct per-year to avoid spikes</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_vs_g5 =</span> <span class="fu">pmin</span>(rate_vs_g5raw, <span class="fu">quantile</span>(rate_vs_g5raw, <span class="fl">0.99</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">inst_s =</span> <span class="fu">scale01</span>(inst_per_1k),</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">rate_s =</span> <span class="fu">scale01</span>(rate_vs_g5),</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">hg_comp =</span> <span class="fl">0.4</span><span class="sc">*</span>inst_s <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span>rate_s</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>early_years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2009</span>, <span class="dv">2010</span>, <span class="dv">2011</span>, <span class="dv">2012</span>)</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>late_years  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2019</span>, <span class="dv">2021</span>, <span class="dv">2022</span>, <span class="dv">2023</span>)</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a><span class="co"># ΔRBI (late - early): negative means affordability improved</span></span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>rbi_change <span class="ot">&lt;-</span> rb_df <span class="sc">%&gt;%</span></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(early_years, late_years)) <span class="sc">%&gt;%</span></span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="fu">if_else</span>(year <span class="sc">%in%</span> early_years, <span class="st">"early"</span>, <span class="st">"late"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, NAME, period) <span class="sc">%&gt;%</span></span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">RBI =</span> <span class="fu">mean</span>(RBI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> period, <span class="at">values_from =</span> RBI) <span class="sc">%&gt;%</span></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">delta_RBI =</span> late <span class="sc">-</span> early)</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Late-period mean HGI</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>hg_late <span class="ot">&lt;-</span> pp <span class="sc">%&gt;%</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> late_years) <span class="sc">%&gt;%</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, NAME) <span class="sc">%&gt;%</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">HGI =</span> <span class="fu">mean</span>(hg_comp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Population growth over window (first vs last)</span></span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>pop_change <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">min</span>(early_years), <span class="fu">max</span>(late_years))) <span class="sc">%&gt;%</span></span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">pop_growth =</span> <span class="fu">last</span>(population) <span class="sc">-</span> <span class="fu">first</span>(population), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_growing =</span> pop_growth <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Join all</span></span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>t6 <span class="ot">&lt;-</span> rbi_change <span class="sc">%&gt;%</span></span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(hg_late, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"NAME"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pop_change, <span class="at">by =</span> <span class="st">"GEOID"</span>)</span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Thresholds and final flag</span></span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>q_hgi_hi  <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t6<span class="sc">$</span>HGI, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>q_dRBI_lo <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t6<span class="sc">$</span>delta_RBI, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)  <span class="co"># most negative quartile</span></span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>t6 <span class="ot">&lt;-</span> t6 <span class="sc">%&gt;%</span></span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yimby_ok =</span> (HGI <span class="sc">&gt;=</span> q_hgi_hi) <span class="sc">&amp;</span> (delta_RBI <span class="sc">&lt;=</span> q_dRBI_lo) <span class="sc">&amp;</span> pop_growing)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualization-1" class="level3">
<h3 class="anchored" data-anchor-id="visualization-1">Visualization 1</h3>
<section id="scatter-housing-growth-vs-rent-burden-change" class="level4">
<h4 class="anchored" data-anchor-id="scatter-housing-growth-vs-rent-burden-change">Scatter: Housing Growth vs Rent Burden Change</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(t6, <span class="fu">aes</span>(<span class="at">x =</span> HGI, <span class="at">y =</span> <span class="sc">-</span>delta_RBI)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Housing Growth vs Improvement in Rent Burden"</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Higher HGI and more negative ΔRBI = better affordability outcomes"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Housing Growth Index (HGI)"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Improvement in Rent Burden (-ΔRBI)"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Source: HUD, Census, BLS"</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="visualization-2" class="level3">
<h3 class="anchored" data-anchor-id="visualization-2">Visualization 2</h3>
<section id="rent-burden-trend-for-yimby-vs-others" class="level4">
<h4 class="anchored" data-anchor-id="rent-burden-trend-for-yimby-vs-others">Rent Burden Trend for YIMBY&nbsp;vs&nbsp;Others</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>rb_df <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(t6 <span class="sc">%&gt;%</span> <span class="fu">select</span>(GEOID, yimby_ok), <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, yimby_ok) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_RBI =</span> <span class="fu">mean</span>(RBI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_RBI, <span class="at">color =</span> yimby_ok)) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"gray40"</span>, <span class="st">"steelblue"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Others"</span>,<span class="st">"YIMBY metros"</span>)) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Rent Burden Over Time: YIMBY CBSAs vs Others"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Rent Burden Index (RBI)"</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">""</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/t6-viz2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>t6 <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(yimby_ok <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(delta_RBI) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NAME, delta_RBI, HGI, pop_growth) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">15</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">c</span>(delta_RBI, HGI, pop_growth), <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top YIMBY CBSAs"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Improving affordability and building housing"</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="mfuhrfeasv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mfuhrfeasv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mfuhrfeasv thead, #mfuhrfeasv tbody, #mfuhrfeasv tfoot, #mfuhrfeasv tr, #mfuhrfeasv td, #mfuhrfeasv th {
  border-style: none;
}

#mfuhrfeasv p {
  margin: 0;
  padding: 0;
}

#mfuhrfeasv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mfuhrfeasv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mfuhrfeasv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mfuhrfeasv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mfuhrfeasv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mfuhrfeasv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mfuhrfeasv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mfuhrfeasv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mfuhrfeasv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mfuhrfeasv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mfuhrfeasv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mfuhrfeasv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mfuhrfeasv .gt_spanner_row {
  border-bottom-style: hidden;
}

#mfuhrfeasv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mfuhrfeasv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mfuhrfeasv .gt_from_md > :first-child {
  margin-top: 0;
}

#mfuhrfeasv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mfuhrfeasv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mfuhrfeasv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mfuhrfeasv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mfuhrfeasv .gt_row_group_first td {
  border-top-width: 2px;
}

#mfuhrfeasv .gt_row_group_first th {
  border-top-width: 2px;
}

#mfuhrfeasv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfuhrfeasv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mfuhrfeasv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mfuhrfeasv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mfuhrfeasv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfuhrfeasv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mfuhrfeasv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mfuhrfeasv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mfuhrfeasv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mfuhrfeasv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mfuhrfeasv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfuhrfeasv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mfuhrfeasv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mfuhrfeasv .gt_left {
  text-align: left;
}

#mfuhrfeasv .gt_center {
  text-align: center;
}

#mfuhrfeasv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mfuhrfeasv .gt_font_normal {
  font-weight: normal;
}

#mfuhrfeasv .gt_font_bold {
  font-weight: bold;
}

#mfuhrfeasv .gt_font_italic {
  font-style: italic;
}

#mfuhrfeasv .gt_super {
  font-size: 65%;
}

#mfuhrfeasv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mfuhrfeasv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mfuhrfeasv .gt_indent_1 {
  text-indent: 5px;
}

#mfuhrfeasv .gt_indent_2 {
  text-indent: 10px;
}

#mfuhrfeasv .gt_indent_3 {
  text-indent: 15px;
}

#mfuhrfeasv .gt_indent_4 {
  text-indent: 20px;
}

#mfuhrfeasv .gt_indent_5 {
  text-indent: 25px;
}

#mfuhrfeasv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mfuhrfeasv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Top YIMBY CBSAs</th>
</tr>
<tr class="gt_heading even">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Improving affordability and building housing</th>
</tr>
<tr class="gt_col_headings header">
<th id="NAME" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">NAME</th>
<th id="delta_RBI" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">delta_RBI</th>
<th id="HGI" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">HGI</th>
<th id="pop_growth" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pop_growth</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Dalton, GA Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−22.56</td>
<td class="gt_row gt_right" headers="HGI">0.20</td>
<td class="gt_row gt_right" headers="pop_growth">10,403.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Salisbury, MD Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−17.13</td>
<td class="gt_row gt_right" headers="HGI">0.19</td>
<td class="gt_row gt_right" headers="pop_growth">9,529.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Salisbury, MD-DE Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−17.13</td>
<td class="gt_row gt_right" headers="HGI">0.20</td>
<td class="gt_row gt_right" headers="pop_growth">9,529.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Gulfport-Biloxi-Pascagoula, MS Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−15.91</td>
<td class="gt_row gt_right" headers="HGI">0.18</td>
<td class="gt_row gt_right" headers="pop_growth">178,136.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Hammond, LA Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−13.05</td>
<td class="gt_row gt_right" headers="HGI">0.23</td>
<td class="gt_row gt_right" headers="pop_growth">19,376.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Hammond, LA Micro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−13.05</td>
<td class="gt_row gt_right" headers="HGI">0.19</td>
<td class="gt_row gt_right" headers="pop_growth">19,376.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Brownsville-Harlingen, TX Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−12.48</td>
<td class="gt_row gt_right" headers="HGI">0.25</td>
<td class="gt_row gt_right" headers="pop_growth">30,339.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Myrtle Beach-Conway-North Myrtle Beach, SC Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−9.85</td>
<td class="gt_row gt_right" headers="HGI">0.39</td>
<td class="gt_row gt_right" headers="pop_growth">133,610.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Myrtle Beach-Conway-North Myrtle Beach, SC-NC Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−9.85</td>
<td class="gt_row gt_right" headers="HGI">0.34</td>
<td class="gt_row gt_right" headers="pop_growth">133,610.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Myrtle Beach-North Myrtle Beach-Conway, SC Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−9.85</td>
<td class="gt_row gt_right" headers="HGI">0.34</td>
<td class="gt_row gt_right" headers="pop_growth">133,610.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Burlington, NC Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−8.49</td>
<td class="gt_row gt_right" headers="HGI">0.17</td>
<td class="gt_row gt_right" headers="pop_growth">28,807.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Grants Pass, OR Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−7.31</td>
<td class="gt_row gt_right" headers="HGI">0.18</td>
<td class="gt_row gt_right" headers="pop_growth">6,795.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Punta Gorda, FL Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−6.59</td>
<td class="gt_row gt_right" headers="HGI">0.31</td>
<td class="gt_row gt_right" headers="pop_growth">49,182.00</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="NAME">Staunton, VA Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−6.23</td>
<td class="gt_row gt_right" headers="HGI">0.26</td>
<td class="gt_row gt_right" headers="pop_growth">11,258.00</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="NAME">Staunton-Stuarts Draft, VA Metro Area</td>
<td class="gt_row gt_right" headers="delta_RBI">−6.23</td>
<td class="gt_row gt_right" headers="HGI">0.26</td>
<td class="gt_row gt_right" headers="pop_growth">11,258.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="findings" class="level3">
<h3 class="anchored" data-anchor-id="findings">Findings</h3>
<section id="the-results-suggest" class="level4">
<h4 class="anchored" data-anchor-id="the-results-suggest">The results suggest:</h4>
<p>Rent Burden Improvement: YIMBY metros showed decreasing rent burden, meaning rents grew more slowly than incomes.</p>
<p>Housing Supply Response: These metros demonstrated positive and above-average housing growth, indicating that they permitted enough new units to meaningfully impact affordability.</p>
<p>Population Growth: YIMBY metros experienced positive population growth, implying that affordability improvements did not come at the cost of attracting new residents.</p>
<p>High Initial Rent Burden: Many YIMBY metros started the period with above-average housing stress, making their improvements especially noteworthy.</p>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion">Conclusion</h4>
<p>Metros that build more housing tend to see better affordability outcomes.</p>
</section>
</section>
<section id="task-7-policy-brief" class="level3">
<h3 class="anchored" data-anchor-id="task-7-policy-brief">Task 7 — Policy Brief</h3>
<section id="executive-summary" class="level4">
<h4 class="anchored" data-anchor-id="executive-summary">Executive Summary</h4>
<p>This brief explores the relationship between housing supply, rent affordability, and population trends across U.S. Core-Based Statistical Areas (CBSAs) from 2009 to 2022. Drawing on data from the ACS, Census Building Permit Survey, and BLS QCEW, it examines how increases in housing stock relate to improvements in rent affordability—particularly in regions that grew rapidly and reduced rent burdens (termed “YIMBY Wins”). The findings show that boosting housing supply—especially in expanding regions—tends to improve affordability. However, outcomes are not uniform, highlighting the importance of sustained and coordinated housing and labor market strategies.</p>
</section>
<section id="background-motivation" class="level4">
<h4 class="anchored" data-anchor-id="background-motivation">Background &amp; Motivation</h4>
<p>Housing affordability has emerged as one of the leading economic challenges in the United States. In many metro areas, housing demand exceeds supply, causing rents to rise and making it harder for middle- and lower-income households to afford a place to live. Policymakers and researchers continue to debate whether increasing housing supply through “YIMBY” (Yes In My Backyard) policies meaningfully addresses affordability, especially in high-growth regions. This brief contributes to that debate by identifying metros that are: • Experiencing population growth • Constructing housing at above-average rates • Reducing rent burdens over time The aim is to understand where increasing housing supply has been most effective and to extract insights that can inform regional and national housing policy.</p>
</section>
<section id="data-methods" class="level4">
<h4 class="anchored" data-anchor-id="data-methods">Data &amp; Methods</h4>
<p>Datasets Used: • ACS (via tidycensus): Rent burden, median rent, household income, population, and household data • Census Building Permit Survey: Permits issued for new housing (used as a proxy for supply growth) • BLS QCEW: Employment and industry data to provide context on local economic growth Key Metrics Defined: Metric Description Housing Growth Index (HGI) Permits issued relative to population size Rent Burden Change (ΔRBI) Reduction in the share of households spending too much on rent Population Change Change in population since 2009 YIMBY Success Flag TRUE if: population ↑, housing growth &gt; avg, rent burden ↓ Interpretation Framework: • A higher HGI indicates stronger housing growth • A more negative ΔRBI signals improved affordability • Metros in the top quartile for HGI and showing a negative ΔRBI are considered “successful supply-growth cases”</p>
</section>
<section id="key-findings" class="level4">
<h4 class="anchored" data-anchor-id="key-findings">Key Findings</h4>
<ol type="1">
<li><p>Many Growing Metros Increased Housing Supply—But Not Equally Major Sunbelt cities and midsize regions in the Southeast and Mountain West saw the highest permitting activity. Cities like Austin, Raleigh, Nashville, Jacksonville, and Salt Lake City demonstrated: • Rapid population growth • Active housing construction • Better rent outcomes compared to slower-growth areas This supports the idea that when housing supply keeps pace with demand, affordability is more likely to improve.</p></li>
<li><p>Not All Fast-Building Areas Saw Affordability Gains Some areas with high building rates still experienced increasing rent burdens. This was often due to extreme demand or a lack of focus on affordability. Examples include popular coastal and recreation-market metros. This illustrates that supply growth alone isn’t enough—protections and affordability measures are also essential.</p></li>
<li><p>“YIMBY Success” Metros Share Key Traits Common Trait Why It Matters Growing workforce A robust job market attracts residents Flexible zoning/land use Fewer obstacles to new housing development Lower starting density Less local resistance to growth Non-superstar status Fewer speculative pressures from investors These cities demonstrate how market-responsive land-use systems can deliver both housing and affordability.</p></li>
<li><p>Worst Affordability Outcomes in Slow-Building Regions Even in metros with little population growth, low permitting activity often coincided with worsening rent burdens. This indicates: • Even modest demand, when paired with tight supply, can hurt affordability • Regions that don’t adapt their housing stock are at risk—even if they’re not booming This challenges the idea that only fast-growing cities need to build more housing.</p></li>
</ol>
</section>
<section id="policy-recommendations" class="level4">
<h4 class="anchored" data-anchor-id="policy-recommendations">Policy Recommendations</h4>
<ol type="1">
<li>Boost Housing Production Capacity • Update zoning laws to allow multifamily and “missing-middle” housing • Allow by-right development near public transit • Invest in infrastructure to support higher density</li>
<li>Link Growth with Affordability Measures • Implement inclusionary zoning policies • Foster public-private partnerships for affordable housing • Offer density bonuses tied to affordability outcomes</li>
<li>Streamline Approvals &amp; Cut Delays • Reform environmental reviews while maintaining protections • Set clear timelines for project approvals</li>
<li>Align Housing with Workforce &amp; Regional Planning • Integrate housing, transit, and job growth strategies • Create regional housing agreements across jurisdictions</li>
<li>Guard Against Displacement • Focus anti-displacement initiatives in vulnerable neighborhoods • Expand rental assistance for at-risk renters</li>
</ol>
</section>
<section id="conclusion-1" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-1">Conclusion</h4>
<p>This analysis supports the argument that growing the housing supply can significantly improve affordability—especially in dynamic, high-growth labor markets. But supply alone isn’t enough. Successful outcomes depend on: • Affordability-focused programs • Efficient permitting processes • Coordinated regional planning To build an effective housing strategy, cities must balance expansion with smart planning and protection for vulnerable populations. The most successful metros provide proven blueprints for future policy action.</p>
</section>
<section id="millennial-appeal-extra-credit-3-related" class="level4">
<h4 class="anchored" data-anchor-id="millennial-appeal-extra-credit-3-related">Millennial Appeal: Extra credit 3 related</h4>
<p>We add the share of residents aged 25–34 as a proxy for young-adult attractiveness. Using ACS table B01001 (1-year files, CBSA geography), we sum male/female 25–29 and 30–34 cohorts and divide by the table total to form millennial_pct. In the latest year, several CBSAs combine strong housing growth with high millennial shares, suggesting production and youth attractiveness can be complementary. Our optional composite YIMBY + Youth index rewards metros with (i) faster permitting (HGI), (ii) lower rent burden (RBI), and (iii) higher millennial share. This adjustment prioritizes policies that not only improve affordability but also sustain a pipeline of young workers and families.</p>
</section>
</section>
<section id="extra-credit-opportunities" class="level3">
<h3 class="anchored" data-anchor-id="extra-credit-opportunities">Extra Credit Opportunities</h3>
<section id="extra-credit-opportunity-01-relationship-diagram" class="level4">
<h4 class="anchored" data-anchor-id="extra-credit-opportunity-01-relationship-diagram">Extra Credit Opportunity #01: Relationship Diagram</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Relationship_diagram.png" class="quarto-figure quarto-figure-center figure-img" style="width:100.0%;height:100.0%"></p>
</figure>
</div>
</section>
<section id="extra-credit-opportunity-02highlighting-important-units-in-a-spaghetti-plot" class="level4">
<h4 class="anchored" data-anchor-id="extra-credit-opportunity-02highlighting-important-units-in-a-spaghetti-plot">Extra Credit Opportunity #02:Highlighting Important Units in a Spaghetti Plot</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"gghighlight"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"gghighlight"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr); <span class="fu">library</span>(ggplot2); <span class="fu">library</span>(gghighlight); <span class="fu">library</span>(stringr)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="fu">exists</span>(<span class="st">"POPULATION"</span>), <span class="fu">exists</span>(<span class="st">"HOUSEHOLDS"</span>), <span class="fu">exists</span>(<span class="st">"cbsa_catalog"</span>))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>hh_size_ec <span class="ot">&lt;-</span> POPULATION <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, year, population) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(HOUSEHOLDS <span class="sc">%&gt;%</span> <span class="fu">select</span>(GEOID, year, households), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hh =</span> population <span class="sc">/</span> households) <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cbsa_catalog <span class="sc">%&gt;%</span> <span class="fu">select</span>(GEOID, NAME), <span class="at">by =</span> <span class="st">"GEOID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.finite</span>(hh), <span class="sc">!</span><span class="fu">is.na</span>(NAME)) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">is_focus =</span> <span class="fu">str_detect</span>(NAME, <span class="fu">fixed</span>(<span class="st">"New York"</span>, <span class="at">ignore_case=</span><span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>               <span class="fu">str_detect</span>(NAME, <span class="fu">fixed</span>(<span class="st">"Los Angeles"</span>, <span class="at">ignore_case=</span><span class="cn">TRUE</span>))</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hh_size_ec, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> hh, <span class="at">group =</span> NAME)) <span class="sc">+</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">ifelse</span>(is_focus, <span class="dv">1</span>, <span class="fl">0.15</span>)),</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"grey50"</span>, <span class="at">linewidth =</span> <span class="fl">0.35</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="sc">~</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(.x, is_focus),</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">color =</span> NAME), <span class="at">linewidth =</span> <span class="fl">1.0</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gghighlight</span>(is_focus, <span class="at">label_key =</span> NAME, <span class="at">use_group_by =</span> <span class="cn">FALSE</span>, <span class="at">keep_scales =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Average Household Size"</span>,</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Household Size Over Time"</span>,</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"NYC &amp; LA highlighted; other CBSAs low-lighted for context"</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/ec2-spaghetti-highlight-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extra-credit-opportunity-03increasing-millenial-appeal" class="level4">
<h4 class="anchored" data-anchor-id="extra-credit-opportunity-03increasing-millenial-appeal">Extra Credit Opportunity #03:Increasing Millenial Appeal</h4>
</section>
<section id="added-into-brief-as-well" class="level4">
<h4 class="anchored" data-anchor-id="added-into-brief-as-well">Added into Brief as well</h4>
<div class="cell">
<details class="code-fold">
<summary>Click to View Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr); <span class="fu">library</span>(purrr); <span class="fu">library</span>(tidyr)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2); <span class="fu">library</span>(stringr); <span class="fu">library</span>(glue)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"tidycensus"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">"tidycensus"</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidycensus)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper: safe multi-year fetch if your project didn't define get_acs_all_years()</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">exists</span>(<span class="st">"get_acs_all_years"</span>)) {</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  get_acs_all_years <span class="ot">&lt;-</span> <span class="cf">function</span>(var, <span class="at">years =</span> <span class="fu">setdiff</span>(<span class="dv">2009</span><span class="sc">:</span><span class="dv">2023</span>, <span class="dv">2020</span>),</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                                <span class="at">geography =</span> <span class="st">"metropolitan statistical area"</span>,</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">survey =</span> <span class="st">"acs1"</span>) {</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">map_df</span>(years, <span class="cf">function</span>(y) {</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>      tidycensus<span class="sc">::</span><span class="fu">get_acs</span>(<span class="at">geography =</span> geography, <span class="at">variables =</span> var,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">year =</span> y, <span class="at">survey =</span> survey) <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transmute</span>(GEOID, NAME, <span class="at">year =</span> y, <span class="sc">!!</span><span class="at">var :=</span> estimate)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables from B01001 (Age by Sex)</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>mm_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"B01001_007"</span>, <span class="co"># Male 25–29</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"B01001_008"</span>, <span class="co"># Male 30–34</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"B01001_031"</span>, <span class="co"># Female 25–29</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"B01001_032"</span>  <span class="co"># Female 30–34</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Pull numerator parts (four cells)</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>mm_parts <span class="ot">&lt;-</span> <span class="fu">map</span>(mm_vars, <span class="sc">~</span> <span class="fu">get_acs_all_years</span>(.x) <span class="sc">%&gt;%</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(GEOID, NAME, year, <span class="sc">!!</span>.x)) <span class="sc">%&gt;%</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(left_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"NAME"</span>,<span class="st">"year"</span>))</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Denominator: table total</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>mm_total <span class="ot">&lt;-</span> <span class="fu">get_acs_all_years</span>(<span class="st">"B01001_001"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, NAME, year, B01001_001)</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Construct millennial %</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>millennial_share <span class="ot">&lt;-</span> mm_parts <span class="sc">%&gt;%</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mm_total, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span>,<span class="st">"NAME"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">millennials =</span> B01001_007 <span class="sc">+</span> B01001_008 <span class="sc">+</span> B01001_031 <span class="sc">+</span> B01001_032,</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">millennial_pct =</span> <span class="dv">100</span> <span class="sc">*</span> millennials <span class="sc">/</span> B01001_001</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(GEOID, NAME, year, millennial_pct) <span class="sc">%&gt;%</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.finite</span>(millennial_pct))</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Latest year visual: Top CBSAs by millennial share</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>metric_year_mm <span class="ot">&lt;-</span> millennial_share <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">latest =</span> <span class="fu">max</span>(year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(latest)</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>top_mm <span class="ot">&lt;-</span> millennial_share <span class="sc">%&gt;%</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> metric_year_mm) <span class="sc">%&gt;%</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(millennial_pct)) <span class="sc">%&gt;%</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">15</span>)</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_mm, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(NAME, millennial_pct), <span class="at">y =</span> millennial_pct)) <span class="sc">+</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">glue</span>(<span class="st">"Millennial Appeal — Top CBSAs in {metric_year_mm}"</span>),</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Share of population ages 25–34 (ACS1, B01001)"</span>,</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"% ages 25–34"</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp02_files/figure-html/ec3-millennial-appeal-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/abbaswaseer\.github\.io\/STA9750-2025-FALL\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>